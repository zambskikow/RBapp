<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Execu√ß√£o Fiscal - Portal Manager</title>
    <!-- Fontes Premium do Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- FontAwesome para √≠cones robustos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Estilos Customizados -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Camada da Tela de Login -->
    <div id="login-overlay" class="login-fullscreen active">
        <div class="glass-card login-card">
            <div class="logo login-logo">
                <i class="fa-solid fa-chart-line"></i> FiscalApp
            </div>
            <h2>Acesso ao Sistema</h2>
            <p style="color:var(--text-muted); margin-bottom: 2rem; font-size: 0.9rem;">Insira suas credenciais para
                continuar</p>

            <form id="login-form">
                <div class="form-group">
                    <label>Usu√°rio</label>
                    <input type="text" id="login-username" class="glass-input" placeholder="Seu nome (Ex: Manager)"
                        required>
                </div>
                <div class="form-group" style="margin-bottom: 2rem;">
                    <label>Senha</label>
                    <input type="password" id="login-password" class="glass-input" placeholder="Sua senha" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 0.9rem; font-size: 1.05rem;">
                    <i class="fa-solid fa-right-to-bracket"></i> Entrar
                </button>
            </form>
            <p id="login-error"
                style="color:var(--danger); margin-top: 1rem; font-size: 0.85rem; display:none; text-align:center;">
                Usu√°rio ou senha inv√°lidos.</p>
        </div>
    </div>

    <!-- Camada de Carregamento Global -->
    <div id="global-loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner-container">
                <div class="loading-spinner"></div>
                <div class="loading-spinner-inner"></div>
            </div>
            <h2 id="loading-title">Processando...</h2>
            <p id="loading-message">Por favor, aguarde um momento.</p>
        </div>
    </div>

    <!-- Cont√™iner Principal do App -->
    <div class="app-container" style="display:none;" id="main-app-container">
        <!-- Navega√ß√£o da Barra Lateral -->
        <aside class="sidebar glass-panel">
            <div class="logo">
                <i class="fa-solid fa-chart-line"></i>
                <div style="display: flex; flex-direction: column;">
                    <span>RB|App</span>
                    <p style="font-size: 0.65rem; opacity: 0.6; margin: 0; font-weight: 400; display: none;"></p>
                </div>
                <!-- Bot√£o Fechar Menu Mobile -->
                <button id="btn-close-sidebar" class="mobile-only-btn" style="margin-left: auto; display: none;">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <i class="fa-solid fa-gauge"></i>
                    <span>Manager Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-view="meu-desempenho">
                    <i class="fa-solid fa-chart-pie"></i>
                    <span>Meu Desempenho</span>
                </a>

                <a href="#" class="nav-item" data-view="operacional">
                    <i class="fa-solid fa-list-check"></i>
                    <span>Painel Operacional</span>
                </a>
                <a href="#" class="nav-item" data-view="clientes">
                    <i class="fa-solid fa-users"></i>
                    <span>Gest√£o de Clientes</span>
                </a>
                <a href="#" class="nav-item" data-view="rotinas">
                    <i class="fa-solid fa-layer-group"></i>
                    <span>Gest√£o de Rotinas</span>
                </a>

                <a href="#" class="nav-item" data-view="mensagens">
                    <i class="fa-solid fa-envelope"></i>
                    <span>Mensagens</span>
                </a>
                <a href="#" class="nav-item" data-view="marketing">
                    <i class="fa-solid fa-bullhorn"></i>
                    <span>Comunica√ß√£o</span>
                </a>

                <a href="#" class="nav-item" data-view="competencias" id="nav-competencias" style="display: none;">
                    <i class="fa-solid fa-calendar-check"></i>
                    <span>Gest√£o de Compet√™ncias</span>
                </a>

                <div class="nav-divider" id="admin-nav-divider" style="display: none;"></div>

                <a href="#" class="nav-item" data-view="settings" id="nav-settings" style="display: none;">
                    <i class="fa-solid fa-gear"></i>
                    <span>Painel de Controle</span>
                </a>
            </nav>
            <div class="user-profile">
                <img src="https://ui-avatars.com/api/?name=Admin&background=6366f1&color=fff" alt="Avatar"
                    class="avatar">
                <div class="user-info">
                    <span class="user-name">Manager</span>
                    <span class="user-role">Setor Fiscal</span>
                </div>
            </div>
        </aside>

        <!-- √Årea de Conte√∫do Principal -->
        <main class="main-content">
            <!-- Barra de Navega√ß√£o Superior -->
            <header class="topbar glass-bar">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button id="btn-toggle-sidebar" class="action-btn" title="Recolher/Expandir Menu Lateral">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <div style="flex: 1;"></div> <!-- Espa√ßador substituindo barra de pesquisa -->
                </div>
                <div class="topbar-actions">
                    <button id="btn-notification" class="action-btn topbar-notification" title="Notifica√ß√µes"
                        style="margin-right: 0.5rem; position: relative;">
                        <i class="fa-solid fa-bell"></i>
                        <span class="badge" style="position: absolute; top: -5px; right: -5px;">0</span>
                    </button>
                    <div class="date-display" id="currentDate">--/--/----</div>
                    <button id="btn-logout" class="btn btn-outline"
                        style="border-color: var(--danger); color: var(--danger); font-size: 0.85rem; padding: 0.4rem 1rem;">
                        <i class="fa-solid fa-power-off"></i> Sair
                    </button>
                </div>
            </header>

            <!-- Visualiza√ß√£o Gest√£o de Compet√™ncias -->
            <div id="view-competencias" class="view-section" style="display: none;">
                <header class="section-header">
                    <div class="section-title-group">
                        <h1><i class="fa-solid fa-calendar-check highlight-text"></i> Gest√£o de Compet√™ncias
                            Administrativa</h1>
                        <p class="subtitle">Controle completo sobre a gera√ß√£o e encerramento de meses.</p>
                    </div>
                    <div class="header-actions">
                        <!-- Gatilho do Modal Adicionar Compet√™ncia -->
                        <button class="btn btn-primary" id="btn-add-competencia">
                            <i class="fa-solid fa-calendar-plus"></i> For√ßar Nova Compet√™ncia Manual
                        </button>
                    </div>
                </header>

                <div class="kpi-dashboard-grid" style="margin-bottom: 2rem;">
                    <div class="glass-card kpi-chip" style="background: rgba(99, 102, 241, 0.05); border: none;">
                        <div class="kpi-chip-icon"><i class="fa-solid fa-layer-group"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Total Compet√™ncias</span>
                            <span class="kpi-chip-value" id="kpi-total-comp-admin">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(16, 185, 129, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--success);"><i
                                class="fa-solid fa-calendar-check"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">M√™s Vigente</span>
                            <span class="kpi-chip-value" id="kpi-active-comp-admin">Nenhum</span>
                        </div>
                    </div>
                </div>

                <div class="glass-card full-table-container">
                    <div class="table-responsive">
                        <table class="data-table" id="competencias-admin-table">
                            <thead>
                                <tr>
                                    <th>C√≥d. Compet√™ncia</th>
                                    <th>Descri√ß√£o / M√™s</th>
                                    <th>Status Principal</th>
                                    <th>Estat√≠sticas R√°pidas</th>
                                    <th style="text-align: right;">A√ß√µes de Controle</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Preenchido pelo JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o Marketing / Comunica√ß√£o -->
            <div id="view-marketing" class="view-section" style="display: none;">
                <header class="section-header">
                    <div class="section-title-group">
                        <h1><i class="fa-solid fa-bullhorn highlight-text"></i> Gest√£o de Marketing Profissional</h1>
                        <p class="subtitle">Planejamento, conte√∫do e m√©tricas n√≠vel ag√™ncia</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="btn-new-marketing-post">
                            <i class="fa-solid fa-plus"></i> Novo Post
                        </button>
                    </div>
                </header>

                <nav class="modal-tabs marketing-tabs" style="margin-bottom: 2rem;">
                    <button type="button" class="modal-tab-btn active" data-marketing-tab="mk-tab-dashboard">
                        <i class="fa-solid fa-chart-line"></i> Dashboard
                    </button>
                    <button type="button" class="modal-tab-btn" data-marketing-tab="mk-tab-kanban">
                        <i class="fa-solid fa-table-columns"></i> Kanban de Conte√∫do
                    </button>
                    <button type="button" class="modal-tab-btn" data-marketing-tab="mk-tab-calendario">
                        <i class="fa-solid fa-calendar-days"></i> Calend√°rio Editorial
                    </button>
                    <button type="button" class="modal-tab-btn" data-marketing-tab="mk-tab-campanhas">
                        <i class="fa-solid fa-rocket"></i> Gest√£o de Campanhas
                    </button>
                    <button type="button" class="modal-tab-btn" data-marketing-tab="mk-tab-equipe">
                        <i class="fa-solid fa-users-gear"></i> Equipe e Permiss√µes
                    </button>
                </nav>

                <!-- 1. DASHBOARD MARKETING -->
                <div id="mk-tab-dashboard" class="marketing-tab-content active">
                    <div class="kpi-dashboard-grid"
                        style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <div class="glass-card kpi-chip" style="background: rgba(99, 102, 241, 0.05);">
                            <div class="kpi-chip-icon"><i class="fa-solid fa-paper-plane"></i></div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-label">Publicados (M√™s)</span>
                                <span class="kpi-chip-value" id="mk-kpi-publicados">0</span>
                            </div>
                        </div>
                        <div class="glass-card kpi-chip" style="background: rgba(245, 158, 11, 0.05);">
                            <div class="kpi-chip-icon" style="color: var(--warning);"><i class="fa-solid fa-clock"></i>
                            </div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-label">Agendados</span>
                                <span class="kpi-chip-value" id="mk-kpi-agendados">0</span>
                            </div>
                        </div>
                        <div class="glass-card kpi-chip" style="background: rgba(16, 185, 129, 0.05);">
                            <div class="kpi-chip-icon" style="color: var(--success);"><i class="fa-solid fa-heart"></i>
                            </div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-label">Engajamento</span>
                                <span class="kpi-chip-value" id="mk-kpi-engajamento">0%</span>
                            </div>
                        </div>
                        <div class="glass-card kpi-chip" style="background: rgba(59, 130, 246, 0.05);">
                            <div class="kpi-chip-icon" style="color: #3B82F6;"><i class="fa-brands fa-whatsapp"></i>
                            </div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-label">Leads WhatsApp</span>
                                <span class="kpi-chip-value" id="mk-kpi-leads">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="charts-grid" style="grid-template-columns: 1fr 1fr; margin-top:2rem; gap:1.5rem;">
                        <div class="glass-card chart-container">
                            <h3>Crescimento de Seguidores</h3>
                            <div class="chart-wrapper"><canvas id="mk-followers-chart"></canvas></div>
                        </div>
                        <div class="glass-card chart-container">
                            <h3>Performance por Plataforma</h3>
                            <div class="chart-wrapper"><canvas id="mk-platform-chart"></canvas></div>
                        </div>
                    </div>
                </div>

                <!-- 2. KANBAN MARKETING -->
                <div id="mk-tab-kanban" class="marketing-tab-content" style="display:none;">
                    <div class="operacional-controls" style="margin-bottom: 2rem;">
                        <div class="search-wrapper">
                            <i class="fa-solid fa-filter"></i>
                            <select id="mk-kanban-filter-plataforma" class="glass-select"
                                style="border:none; background:transparent;">
                                <option value="All">Todas Plataformas</option>
                                <option value="Instagram">Instagram</option>
                                <option value="Facebook">Facebook</option>
                                <option value="WhatsApp">WhatsApp</option>
                            </select>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <select id="mk-kanban-filter-responsavel" class="glass-select">
                                <option value="All">Todos Respons√°veis</option>
                            </select>
                            <button class="btn btn-secondary" id="btn-mk-refresh-kanban"><i
                                    class="fa-solid fa-rotate"></i></button>
                        </div>
                    </div>

                    <div class="kanban-board-container" style="overflow-x: auto; padding-bottom: 2rem;">
                        <div class="kanban-board"
                            style="display: grid; grid-template-columns: repeat(8, 300px); gap: 1.5rem; min-width: 2500px;">
                            <!-- Colunas do M√≥dulo Profissional -->
                            <div class="kanban-column" id="mk-col-ideias">
                                <div class="kanban-col-header">
                                    <h3>üí° Ideias</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Ideia"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-planejamento">
                                <div class="kanban-col-header">
                                    <h3>üìù Planejamento</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Planejamento"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-producao">
                                <div class="kanban-col-header">
                                    <h3>üé¨ Em Produ√ß√£o</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Produ√ß√£o"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-design">
                                <div class="kanban-col-header">
                                    <h3>üé® Em Design</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Design"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-revisao">
                                <div class="kanban-col-header">
                                    <h3>üîç Em Revis√£o</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Revis√£o"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-aprovado">
                                <div class="kanban-col-header">
                                    <h3>‚úÖ Aprovado</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Aprovado"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-agendado">
                                <div class="kanban-col-header">
                                    <h3>üìÖ Agendado</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Agendado"></div>
                            </div>
                            <div class="kanban-column" id="mk-col-publicado">
                                <div class="kanban-col-header">
                                    <h3>üöÄ Publicado</h3><span class="count-badge">0</span>
                                </div>
                                <div class="kanban-cards-area" data-status="Publicado"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. CALEND√ÅRIO EDITORIAL -->
                <div id="mk-tab-calendario" class="marketing-tab-content" style="display:none;">
                    <div class="glass-card" style="padding: 2rem; min-height: 600px;">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 2rem;">
                            <h2 id="mk-calendar-month-year">Fevereiro 2026</h2>
                            <div style="display:flex; gap:0.5rem;">
                                <button class="btn btn-outline" id="btn-mk-prev-month"><i
                                        class="fa-solid fa-chevron-left"></i></button>
                                <button class="btn btn-outline" id="btn-mk-next-month"><i
                                        class="fa-solid fa-chevron-right"></i></button>
                                <button class="btn btn-primary" id="btn-mk-today">Hoje</button>
                            </div>
                        </div>
                        <div id="mk-calendar-grid" class="calendar-grid">
                            <!-- Injetado pelo marketing.js -->
                        </div>
                    </div>
                </div>

                <!-- 4. GEST√ÉO DE CAMPANHAS -->
                <div id="mk-tab-campanhas" class="marketing-tab-content" style="display:none;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem;">
                        <h2>Campanhas Ativas</h2>
                        <button class="btn btn-primary" id="btn-mk-new-campanha"><i class="fa-solid fa-plus"></i> Nova
                            Campanha</button>
                    </div>
                    <div class="glass-card full-table-container">
                        <table class="data-table" id="mk-campanhas-table">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Objetivo</th>
                                    <th>Plataforma</th>
                                    <th>Or√ßamento</th>
                                    <th>Per√≠odo</th>
                                    <th>ROI</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- 5. EQUIPE MARKETING -->
                <div id="mk-tab-equipe" class="marketing-tab-content" style="display:none;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem;">
                        <h2>Gest√£o de Equipe de Marketing</h2>
                        <button class="btn btn-primary" id="btn-mk-add-equipe"><i class="fa-solid fa-user-plus"></i>
                            Adicionar Membro</button>
                    </div>
                    <div class="glass-card full-table-container">
                        <table class="data-table" id="mk-equipe-table">
                            <thead>
                                <tr>
                                    <th>Membro</th>
                                    <th>Fun√ß√£o</th>
                                    <th>Tarefas Ativas</th>
                                    <th>Produtividade</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o Dashboard (Gerente) -->
            <div id="view-dashboard" class="view-section active">
                <header class="section-header">
                    <div class="section-title-group">
                        <h1>Vis√£o Geral do M√™s</h1>
                        <p class="subtitle">Acompanhe a sa√∫de das entregas fiscais de forma centralizada</p>
                    </div>
                    <div class="header-actions" style="display:flex; gap:1rem; align-items:center;">
                        <select id="dash-competencia-filter" class="glass-select" style="min-width: 150px;">
                            <!-- Preenchido dinamicamente -->
                        </select>
                        <select id="dash-user-filter" class="glass-select" style="min-width: 150px;">
                            <option value="All">Todos Analistas</option>
                            <!-- Preenchido dinamicamente -->
                        </select>
                        <button class="btn btn-secondary" onclick="window.print()" style="padding: 0.75rem 1.25rem;">
                            <i class="fa-solid fa-print"></i> Relat√≥rio
                        </button>
                    </div>
                </header>

                <!-- Cart√µes KPI: Vis√£o Estrat√©gica -->
                <div class="kpi-dashboard-grid">
                    <!-- Coluna 1: Volume Geral -->
                    <div class="glass-card"
                        style="padding: 1.25rem; display: flex; flex-direction: column; gap: 0.8rem;">
                        <h4
                            style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">
                            Volume de Entregas</h4>
                        <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
                            <div class="kpi-chip" style="background: rgba(255,255,255,0.03); border: none; flex: 1;">
                                <div class="kpi-chip-icon"><i class="fa-solid fa-list-check"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-label">Total Geral</span>
                                    <span class="kpi-chip-value" id="kpi-total">0</span>
                                </div>
                            </div>
                            <div class="kpi-chip" style="background: rgba(99, 102, 241, 0.05); border: none; flex: 1;">
                                <div class="kpi-chip-icon" style="color: var(--primary-light);"><i
                                        class="fa-solid fa-percent"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-label">Taxa Entrega</span>
                                    <span class="kpi-chip-value" id="kpi-eficiencia">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Coluna 2: Status Cr√≠tico -->
                    <div class="glass-card"
                        style="padding: 1.25rem; display: flex; flex-direction: column; gap: 0.8rem;">
                        <h4
                            style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">
                            Monitoramento de Prazos</h4>
                        <div class="kpi-scroll-row">
                            <div class="kpi-chip"
                                style="background: rgba(16, 185, 129, 0.05); border: none; min-width: 110px;">
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-done" style="color: var(--success);">0</span>
                                    <span class="kpi-chip-label">Conclu√≠dos</span>
                                </div>
                            </div>
                            <div class="kpi-chip"
                                style="background: rgba(245, 158, 11, 0.05); border: none; min-width: 110px;">
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-warning"
                                        style="color: var(--warning);">0</span>
                                    <span class="kpi-chip-label">Hoje</span>
                                </div>
                            </div>
                            <div class="kpi-chip"
                                style="background: rgba(239, 68, 68, 0.05); border: none; min-width: 110px;">
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-late" style="color: var(--danger);">0</span>
                                    <span class="kpi-chip-label">Atrasados</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Coluna 3: Alertas de Gest√£o -->
                    <div class="glass-card"
                        style="padding: 1.25rem; display: flex; flex-direction: column; gap: 0.8rem;">
                        <h4
                            style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">
                            Alertas de Gest√£o</h4>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <div id="kpi-alert-carga" class="table-badge warning"
                                style="font-size: 0.75rem; padding: 0.5rem; width: 100%; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                                <i class="fa-solid fa-user-clock"></i> <span>Maior Carga: --</span>
                            </div>
                            <div id="kpi-alert-risco" class="table-badge danger"
                                style="font-size: 0.75rem; padding: 0.5rem; width: 100%; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                                <i class="fa-solid fa-triangle-exclamation"></i> <span>Cr√≠tico: --</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Se√ß√£o de Gr√°ficos Principais -->
                <div class="charts-grid" style="grid-template-columns: 1fr 1fr; margin-bottom: 2rem;">
                    <div class="glass-card chart-container">
                        <h3 style="font-size: 0.9rem;"><i class="fa-solid fa-chart-bar" style="color:var(--accent)"></i>
                            Produtividade Equipe</h3>
                        <div class="chart-wrapper" style="height: 200px;">
                            <canvas id="teamChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-card chart-container">
                        <h3 style="font-size: 0.9rem;"><i class="fa-solid fa-layer-group"
                                style="color:var(--success)"></i> Carga por Setor</h3>
                        <div class="chart-wrapper" style="height: 200px;">
                            <canvas id="sectorChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="charts-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                    <div class="glass-card chart-container">
                        <h3>Status Sem√°foro (Sa√∫de)</h3>
                        <div class="chart-wrapper">
                            <canvas id="semaforoChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-card table-container">
                        <div class="table-header-action">
                            <h3>A√ß√µes Cr√≠ticas (Gargalos)</h3>
                            <span class="table-filter-info">Prioridade M√°xima</span>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table" id="critical-table">
                                <thead>
                                    <tr>
                                        <th>Cliente</th>
                                        <th>Rotina</th>
                                        <th>Resp.</th>
                                        <th>Prazo</th>
                                        <th>Status Auto</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Preenchido pelo JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Desempenho da Equipe -->
                <div class="glass-card full-table-container" style="margin-top: 1.5rem;">
                    <div class="table-header-action">
                        <h3>Desempenho da Equipe</h3>
                        <span class="table-filter-info">Produtividade no Per√≠odo</span>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table" id="team-performance-table">
                            <thead>
                                <tr>
                                    <th>Funcion√°rio</th>
                                    <th>Total Entregas</th>
                                    <th>Conclu√≠das</th>
                                    <th>Vencendo Hoje</th>
                                    <th>Atrasadas</th>
                                    <th>% Rendimento</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Preenchido pelo JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o Meu Desempenho (KPIs Individuais) -->
            <div id="view-meu-desempenho" class="view-section" style="display: none;">
                <header class="section-header">
                    <div>
                        <h1>Meu Desempenho</h1>
                        <p class="subtitle">An√°lise avan√ßada de meta e produtividade individual</p>
                    </div>
                    <div class="header-actions" style="display:flex; gap:0.5rem; align-items:center;">
                        <select id="meu-competencia-filter" class="glass-select" style="min-width: 140px;">
                            <!-- Preenchido dinamicamente -->
                        </select>
                        <button class="btn btn-primary" onclick="window.print()"><i class="fa-solid fa-print"></i>
                            Imprimir Extrato</button>
                    </div>
                </header>

                <!-- Cart√µes KPI Expandidos -->
                <div class="kpi-desempenho-grid">
                    <div class="glass-card kpi-chip" style="background: rgba(255,255,255,0.03); border: none;">
                        <div class="kpi-chip-icon"><i class="fa-solid fa-bullseye"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Total Tarefas</span>
                            <span class="kpi-chip-value" id="kpi-meu-total">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(16, 185, 129, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--success);"><i class="fa-solid fa-trophy"></i>
                        </div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Conclu√≠das</span>
                            <span class="kpi-chip-value" id="kpi-meu-done">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip"
                        style="background: rgba(99, 102, 241, 0.08); border: 1px solid var(--primary-light);">
                        <div class="kpi-chip-icon" style="color: var(--primary-light);"><i class="fa-solid fa-bolt"></i>
                        </div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Efici√™ncia</span>
                            <span class="kpi-chip-value" id="kpi-meu-score">0%</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(245, 158, 11, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--warning);"><i class="fa-solid fa-clock"></i>
                        </div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Vencendo Hoje</span>
                            <span class="kpi-chip-value" id="kpi-meu-warning">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(239, 68, 68, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--danger);"><i
                                class="fa-solid fa-skull-crossbones"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Atrasadas</span>
                            <span class="kpi-chip-value" id="kpi-meu-late">0</span>
                        </div>
                    </div>
                </div>

                <div class="charts-grid" style="grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                    <!-- Gr√°fico Principal: Sa√∫de das Entregas (Rosca) -->
                    <div class="glass-card chart-container">
                        <h3><i class="fa-solid fa-heart-pulse" style="color:var(--danger)"></i> Sa√∫de das minhas
                            Entregas</h3>
                        <div class="chart-wrapper" style="height: 250px;">
                            <canvas id="meuSemaforoChart"></canvas>
                        </div>
                    </div>

                    <!-- Gr√°fico Novo: Mix por Setor (Radar) -->
                    <div class="glass-card chart-container">
                        <h3><i class="fa-solid fa-chart-pie" style="color:var(--accent)"></i> Atua√ß√£o por Setor</h3>
                        <div class="chart-wrapper" style="height: 250px;">
                            <canvas id="meuRadarChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="charts-grid" style="grid-template-columns: 1.5fr 1fr; gap: 1.5rem;">
                    <!-- Lista de Prioridades -->
                    <div class="glass-card table-container">
                        <div class="table-header-action">
                            <h3>Minhas Pr√≥ximas Entregas (Prioridade)</h3>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table" id="minhas-proximas-table">
                                <thead>
                                    <tr>
                                        <th>Cliente</th>
                                        <th>Rotina</th>
                                        <th>Prazo</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Preenchido pelo JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Gr√°fico Novo: Curva Semanal -->
                    <div class="glass-card chart-container">
                        <h3><i class="fa-solid fa-chart-line" style="color:var(--success)"></i> Entrega Semanal</h3>
                        <div class="chart-wrapper" style="height: 200px;">
                            <canvas id="meuWeeklyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o Operacional (√Årea do Usu√°rio) -->
            <div id="view-operacional" class="view-section" style="display: none;">
                <header class="section-header">
                    <div>
                        <h1>Minhas Tarefas</h1>
                        <p class="subtitle">Gest√£o di√°ria de rotinas fiscais e documenta√ß√£o</p>
                    </div>
                    <div class="header-actions" style="display:flex; gap:0.5rem; align-items:center;">
                        <select id="competencia-filter" class="glass-select" style="min-width: 140px;">
                            <!-- Preenchido dinamicamente pelo JS -->
                        </select>
                        <select id="user-filter" class="glass-select">
                            <option value="All">Todos os Respons√°veis</option>
                            <option value="Dandara">Dandara</option>
                            <option value="Manager">Manager</option>
                        </select>
                    </div>
                </header>

                <!-- Novos KPIs do Painel Operacional -->
                <div class="glass-card" style="padding: 1rem; margin-bottom: 1.5rem;">
                    <div class="kpi-scroll-row">
                        <div class="kpi-chip" style="background: rgba(255,255,255,0.03); border: none;">
                            <div class="kpi-chip-icon"><i class="fa-solid fa-list-check"></i></div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-value" id="kpi-operacional-total">0</span>
                                <span class="kpi-chip-label">Total</span>
                            </div>
                        </div>
                        <div class="kpi-chip" style="background: rgba(16, 185, 129, 0.05); border: none;">
                            <div class="kpi-chip-icon" style="color: var(--success);"><i
                                    class="fa-solid fa-check-double"></i></div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-value" id="kpi-operacional-done">0</span>
                                <span class="kpi-chip-label">Conclu√≠dos</span>
                            </div>
                        </div>
                        <div class="kpi-chip" style="background: rgba(59, 130, 246, 0.05); border: none;">
                            <div class="kpi-chip-icon" style="color: #3B82F6;"><i class="fa-solid fa-bars-progress"></i>
                            </div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-value" id="kpi-operacional-andamento">0</span>
                                <span class="kpi-chip-label">Andamento</span>
                            </div>
                        </div>
                        <div class="kpi-chip" style="background: rgba(239, 68, 68, 0.05); border: none;">
                            <div class="kpi-chip-icon" style="color: var(--danger);"><i
                                    class="fa-solid fa-triangle-exclamation"></i></div>
                            <div class="kpi-chip-info">
                                <span class="kpi-chip-value" id="kpi-operacional-late">0</span>
                                <span class="kpi-chip-label">Atrasados</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="operacional-controls">
                    <div class="search-wrapper">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <input type="text" id="operacional-search" placeholder="Pesquisar por rotina ou cliente...">
                    </div>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <select id="operacional-sort" class="glass-select" style="min-width: 200px;">
                            <option value="prazo-asc">Prazo (Mais Pr√≥ximo)</option>
                            <option value="prazo-desc">Prazo (Mais Longe)</option>
                            <option value="cliente-az">Cliente (A ‚Üí Z)</option>
                            <option value="cliente-za">Cliente (Z ‚Üí A)</option>
                            <option value="rotina-az">Rotina (A ‚Üí Z)</option>
                        </select>
                        <button class="btn btn-primary" id="btn-nova-demanda-eventual"
                            onclick="openDemandaEventualModal()"
                            style="white-space: nowrap; padding: 0.6rem 1.1rem; font-size: 0.85rem;">
                            <i class="fa-solid fa-bolt"></i> Nova Rotina Eventual
                        </button>
                    </div>
                </div>

                <div id="operacional-groups-container">
                    <!-- Grupos de rotinas injetados pelo app.js aqui -->
                </div>
            </div>

            <!-- Visualiza√ß√£o Gest√£o de Clientes -->
            <div id="view-clientes" class="view-section" style="display: none;">

                <!-- Cont√™iner da Lista Principal -->
                <div id="clientes-list-container">
                    <header class="section-header">
                        <div>
                            <h1>Gest√£o de Clientes</h1>
                            <p class="subtitle">Base de clientes e Painel de Rotinas Fiscais</p>
                        </div>
                        <div class="header-actions" style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button class="btn btn-primary" id="btn-add-client">
                                <i class="fa-solid fa-plus"></i> Novo Cliente
                            </button>
                        </div>
                    </header>

                    <div class="glass-card" style="padding: 1rem; margin-bottom: 2rem;">
                        <h4
                            style="font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.8rem; letter-spacing: 1px;">
                            Resumo da Base</h4>
                        <div class="kpi-scroll-row">
                            <div class="kpi-chip"
                                style="background: rgba(99, 102, 241, 0.05); border: 1px solid rgba(99, 102, 241, 0.2);">
                                <div class="kpi-chip-icon"
                                    style="background: rgba(99, 102, 241, 0.15); color: var(--primary-light);"><i
                                        class="fa-solid fa-users"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-total-clientes">0</span>
                                    <span class="kpi-chip-label">Total</span>
                                </div>
                            </div>
                            <div class="kpi-chip" style="background: rgba(239, 68, 68, 0.05);">
                                <div class="kpi-chip-icon"
                                    style="background: rgba(239, 68, 68, 0.15); color: var(--danger);"><i
                                        class="fa-solid fa-user-slash"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-inativos">0</span>
                                    <span class="kpi-chip-label">Inativos</span>
                                </div>
                            </div>
                            <div class="kpi-chip" style="background: rgba(16, 185, 129, 0.05);">
                                <div class="kpi-chip-icon"
                                    style="background: rgba(16, 185, 129, 0.15); color: var(--success);"><i
                                        class="fa-solid fa-leaf"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-simples">0</span>
                                    <span class="kpi-chip-label">Simples</span>
                                </div>
                            </div>
                            <div class="kpi-chip" style="background: rgba(245, 158, 11, 0.05);">
                                <div class="kpi-chip-icon"
                                    style="background: rgba(245, 158, 11, 0.15); color: var(--warning);"><i
                                        class="fa-solid fa-building"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-presumido">0</span>
                                    <span class="kpi-chip-label">Presumido</span>
                                </div>
                            </div>
                            <div class="kpi-chip" style="background: rgba(59, 130, 246, 0.05);">
                                <div class="kpi-chip-icon"
                                    style="background: rgba(59, 130, 246, 0.15); color: #3B82F6;"><i
                                        class="fa-solid fa-scale-balanced"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-real">0</span>
                                    <span class="kpi-chip-label">Lucro Real</span>
                                </div>
                            </div>
                            <div class="kpi-chip" style="background: rgba(139, 92, 246, 0.05);">
                                <div class="kpi-chip-icon"
                                    style="background: rgba(139, 92, 246, 0.15); color: var(--accent);"><i
                                        class="fa-solid fa-store"></i></div>
                                <div class="kpi-chip-info">
                                    <span class="kpi-chip-value" id="kpi-mei">0</span>
                                    <span class="kpi-chip-label">MEI</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Barra de Pesquisa e Controles de Ordena√ß√£o -->
                    <div class="operacional-controls" style="margin-bottom: 1rem;">
                        <div class="search-wrapper">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            <input type="text" id="clientes-search" placeholder="Pesquisar por nome, CNPJ ou c√≥digo...">
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <select id="clientes-sort" class="glass-select" style="min-width: 200px;">
                                <option value="az">Raz√£o Social (A ‚Üí Z)</option>
                                <option value="za">Raz√£o Social (Z ‚Üí A)</option>
                                <option value="codigo-asc">C√≥digo (Crescente)</option>
                                <option value="codigo-desc">C√≥digo (Decrescente)</option>
                                <option value="recente" selected>Mais Recente</option>
                                <option value="antigo">Mais Antigo</option>
                                <option value="regime">Regime Tribut√°rio</option>
                            </select>
                        </div>
                    </div>

                    <div class="glass-card full-table-container">
                        <div class="table-responsive">
                            <table class="data-table" id="clients-table">
                                <thead>
                                    <tr>
                                        <th style="width: 40px; text-align: center;">
                                            <input type="checkbox" id="select-all-clients" class="custom-checkbox">
                                        </th>
                                        <th>C√≥d</th>
                                        <th>Raz√£o Social</th>
                                        <th>CNPJ</th>
                                        <th>Regime Tribut√°rio</th>
                                        <th style="text-align: center;">Drive</th>
                                        <th>Status Motor</th>
                                        <th>
                                            <div
                                                style="display: flex; align-items: center; justify-content: space-between;">
                                                <span>A√ß√µes</span>
                                                <button id="btn-delete-clients-header" class="btn-bulk-delete-header"
                                                    style="display: none;" title="Excluir Selecionados">
                                                    <i class="fa-solid fa-trash"></i> <span
                                                        id="delete-clients-header-count">0</span>
                                                </button>
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Painel de Detalhes do Cliente (Tela Principal) -->
                <div id="clientes-detail-panel" class="glass-card fade-in" style="display: none; padding: 3rem;">
                    <header class="detail-header">
                        <div class="header-left">
                            <button class="btn btn-secondary btn-back" id="btn-back-clients-list" type="button">
                                <i class="fa-solid fa-arrow-left"></i>
                            </button>
                            <div class="detail-title-group">
                                <i class="fa-solid fa-user-gear"></i>
                                <div>
                                    <h2 id="client-panel-title">Ficha do Cliente</h2>
                                    <p id="client-panel-subtitle">Gerencie as informa√ß√µes e acessos de <span
                                            id="client-header-name" class="highlight-text">...</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="header-actions">
                            <button class="btn btn-primary" form="add-client-form" type="submit"
                                id="client-modal-submit-btn" style="padding: 0.8rem 2rem; border-radius: 50px;">
                                <i class="fa-solid fa-save"></i> Salvar Altera√ß√µes
                            </button>
                        </div>
                    </header>

                    <nav class="modal-tabs">
                        <div style="display: flex; gap: 3rem;">
                            <button type="button" class="modal-tab-btn active" data-tab="tab-geral"><i
                                    class="fa-solid fa-circle-info"></i> Geral</button>
                            <button type="button" class="modal-tab-btn" data-tab="tab-contato"><i
                                    class="fa-solid fa-address-book"></i> Contatos</button>
                            <button type="button" class="modal-tab-btn" data-tab="tab-acessos"><i
                                    class="fa-solid fa-key"></i>
                                Acessos/Logins</button>
                            <button type="button" class="modal-tab-btn" data-tab="tab-rotinas"><i
                                    class="fa-solid fa-calendar-check"></i> Rotinas</button>
                        </div>
                        <div id="client-status-container"
                            style="display: none; align-items: center; gap: 0.5rem; background: rgba(0,0,0,0.1); padding: 5px 12px; border-radius: 20px; border: 1px solid var(--border-glass);">
                            <label class="custom-toggle" style="margin: 0;">
                                <input type="checkbox" id="client-ativo" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-label" id="client-status-label">Ativo</span>
                            </label>
                        </div>
                    </nav>

                    <div class="panel-body">
                        <form id="add-client-form">
                            <input type="hidden" id="client-id" value="">

                            <!-- Aba: Geral -->
                            <div id="tab-geral" class="tab-content active">
                                <div class="form-grid" style="grid-template-columns: 1fr 2fr;">
                                    <div class="form-group">
                                        <label>C√≥digo</label>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <input type="text" id="client-codigo" class="glass-input"
                                                placeholder="Ex: 001">
                                            <button type="button" id="btn-generate-code" class="btn btn-secondary"
                                                title="Gerar C√≥digo Aleat√≥rio" style="padding: 0 1rem;">
                                                <i class="fa-solid fa-dice"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Raz√£o Social</label>
                                        <input type="text" id="client-razao" required class="glass-input"
                                            placeholder="Ex: Nova Empresa Ltda">
                                    </div>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>CNPJ</label>
                                        <input type="text" id="client-cnpj" required class="glass-input"
                                            placeholder="00.000.000/0001-00">
                                    </div>
                                    <div class="form-group">
                                        <label>Regime Tribut√°rio</label>
                                        <select id="client-regime" class="glass-select" style="width: 100%;">
                                            <option value="Simples Nacional">Simples Nacional</option>
                                            <option value="Lucro Presumido">Lucro Presumido</option>
                                            <option value="Lucro Real">Lucro Real</option>
                                            <option value="MEI">MEI</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Inscri√ß√£o Estadual</label>
                                        <input type="text" id="client-ie" class="glass-input"
                                            placeholder="Inscri√ß√£o Estadual">
                                    </div>
                                    <div class="form-group">
                                        <label>Inscri√ß√£o Municipal</label>
                                        <input type="text" id="client-im" class="glass-input"
                                            placeholder="Inscri√ß√£o Municipal">
                                    </div>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Data de Abertura</label>
                                        <input type="date" id="client-abertura" class="glass-input">
                                    </div>
                                    <div class="form-group">
                                        <label>Tipo de Empresa</label>
                                        <input type="text" id="client-tipo" class="glass-input"
                                            placeholder="Ex: LTDA, EIRELI...">
                                    </div>
                                </div>
                            </div>

                            <!-- Aba: Contato -->
                            <div id="tab-contato" class="tab-content">
                                <div class="form-section-title"><i class="fa-solid fa-headset"></i> Atendimento e
                                    Contato</div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Nome do Contato Principal</label>
                                        <input type="text" id="client-contato-nome" class="glass-input"
                                            placeholder="Ex: Jo√£o Silva">
                                    </div>
                                    <div class="form-group">
                                        <label>Respons√°vel Fiscal Interno</label>
                                        <input type="text" id="client-resp-fiscal" class="glass-input"
                                            placeholder="Quem atende este cliente?">
                                    </div>
                                </div>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>E-mail</label>
                                        <input type="email" id="client-email" class="glass-input"
                                            placeholder="email@cliente.com">
                                    </div>
                                    <div class="form-group">
                                        <label>Telefone / WhatsApp</label>
                                        <input type="text" id="client-telefone" class="glass-input"
                                            placeholder="(00) 00000-0000">
                                    </div>
                                </div>
                            </div>

                            <!-- Aba: Acessos -->
                            <div id="tab-acessos" class="tab-content">
                                <div class="form-section-title"><i class="fa-solid fa-shield-halved"></i>
                                    Credenciais e
                                    Acessos</div>
                                <div class="access-grid">
                                    <div class="access-card ecac">
                                        <label>e-CAC (Federal)</label>
                                        <div class="access-inputs">
                                            <input type="text" id="login-ecac" class="glass-input"
                                                placeholder="C√≥digo/CPF/CNPJ">
                                            <div class="password-wrapper">
                                                <input type="password" id="senha-ecac" class="glass-input"
                                                    placeholder="Senha">
                                                <button type="button" class="btn-toggle-password" title="Ver Senha">
                                                    <i class="fa-solid fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="access-card sefaz">
                                        <label>SEFAZ (Estadual)</label>
                                        <div class="access-inputs">
                                            <input type="text" id="login-sefaz" class="glass-input"
                                                placeholder="Usu√°rio">
                                            <div class="password-wrapper">
                                                <input type="password" id="senha-sefaz" class="glass-input"
                                                    placeholder="Senha">
                                                <button type="button" class="btn-toggle-password" title="Ver Senha">
                                                    <i class="fa-solid fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="access-card pref">
                                        <label>Prefeitura (Municipal)</label>
                                        <div class="access-inputs">
                                            <input type="text" id="login-pref" class="glass-input"
                                                placeholder="Usu√°rio">
                                            <div class="password-wrapper">
                                                <input type="password" id="senha-pref" class="glass-input"
                                                    placeholder="Senha">
                                                <button type="button" class="btn-toggle-password" title="Ver Senha">
                                                    <i class="fa-solid fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="access-card dominio">
                                        <label>Sistema Dom√≠nio</label>
                                        <div class="access-inputs">
                                            <input type="text" id="login-dominio" class="glass-input"
                                                placeholder="Usu√°rio">
                                            <div class="password-wrapper">
                                                <input type="password" id="senha-dominio" class="glass-input"
                                                    placeholder="Senha">
                                                <button type="button" class="btn-toggle-password" title="Ver Senha">
                                                    <i class="fa-solid fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 2rem;">
                                    <label>Outros Acessos e Observa√ß√µes</label>
                                    <textarea id="client-outros-acessos" class="glass-input" style="min-height: 120px;"
                                        placeholder="Ex: Usu√°rio do portal do caminhoneiro, senha do certificado digital..."></textarea>
                                </div>
                            </div>

                            <!-- Aba: Rotinas -->
                            <div id="tab-rotinas" class="tab-content">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Link Google Drive (Pasta do Cliente)</label>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <input type="text" id="client-drive" class="glass-input"
                                                placeholder="https://drive.google.com/...">
                                            <button type="button" class="btn btn-secondary"
                                                onclick="window.open(document.getElementById('client-drive').value, '_blank')"
                                                style="padding: 0 1rem;"><i
                                                    class="fa-solid fa-external-link"></i></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 1.5rem;">
                                    <label>Rotinas Obrigat√≥rias para este Cliente</label>
                                    <div id="rotinas-checkbox-grid"
                                        style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-top: 1rem;">
                                        <!-- Injetado pelo app.js -->
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o Gest√£o de Rotinas Base -->
            <div id="view-rotinas" class="view-section" style="display: none;">

                <!-- Painel da Lista Principal -->
                <div id="rotinas-list-panel">
                    <header class="section-header">
                        <div>
                            <h1>Gest√£o de Rotinas</h1>
                            <p class="subtitle">Administra√ß√£o das matrizes de rotinas e prazos padr√£o</p>
                        </div>
                        <div class="header-actions" style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary" id="btn-manage-setores">
                                <i class="fa-solid fa-layer-group"></i> Gerenciar Setores
                            </button>
                            <button class="btn btn-primary" id="btn-add-rotina">
                                <i class="fa-solid fa-plus"></i> Nova Rotina
                            </button>
                        </div>
                    </header>

                    <div class="glass-card full-table-container">
                        <div class="table-responsive">
                            <table class="data-table" id="rotinas-table">
                                <thead>
                                    <tr>
                                        <th>Nome da Rotina</th>
                                        <th>Frequ√™ncia</th>
                                        <th>Setor</th>
                                        <th>Respons√°veis</th>
                                        <th>Clientes</th>
                                        <th>Dia Vencimento</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Preenchido pelo JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Painel de Detalhes para Nova/Editar Rotina -->
                <div class="glass-card fade-in" id="rotinas-detail-panel" style="display: none; padding: 2rem;">
                    <header class="section-header"
                        style="margin-bottom: 2rem; border-bottom: 1px solid var(--border-glass); padding-bottom: 1rem; display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <button class="btn btn-secondary" id="btn-back-rotinas-list" type="button"
                                style="padding: 0.5rem 1rem;">
                                <i class="fa-solid fa-arrow-left"></i> Voltar
                            </button>
                            <h2 id="modal-rotina-title"><i class="fa-solid fa-layer-group highlight-text"></i> Nova
                                Rotina</h2>
                        </div>
                        <div class="header-actions">
                            <button class="btn btn-primary" form="add-rotina-form" type="submit"
                                id="btn-save-rotina-detail" style="padding: 0.5rem 1.5rem; font-size: 1rem;">
                                <i class="fa-solid fa-save"></i> Salvar Rotina
                            </button>
                        </div>
                    </header>

                    <div class="modal-body" style="padding-bottom: 0;">
                        <form id="add-rotina-form">
                            <input type="hidden" id="rotina-id" value="">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <!-- Coluna Esquerda: Configura√ß√µes da Rotina -->
                                <div>
                                    <h3 style="margin-bottom: 1rem; color: var(--text-main); font-size: 1.1rem;"><i
                                            class="fa-solid fa-sliders"></i> Configura√ß√µes da Rotina</h3>

                                    <div class="form-group" style="margin-bottom: 1rem;">
                                        <label>Nome da Rotina</label>
                                        <input type="text" id="rotina-nome" required class="glass-input"
                                            placeholder="Ex: Declara√ß√£o XPTO">
                                    </div>
                                    <div class="form-grid" style="margin-bottom: 1rem;">
                                        <div class="form-group">
                                            <label>Frequ√™ncia</label>
                                            <select id="rotina-frequencia" class="glass-select" style="width: 100%;">
                                                <option value="Mensal">Mensal (Dia fixo)</option>
                                                <option value="Anual">Anual (Data exata)</option>
                                                <option value="Eventual">Eventual (Por Demanda)</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>Setor Relacionado</label>
                                            <select id="rotina-setor" class="glass-select" style="width: 100%;">
                                                <!-- Preenchido dinamicamente pelo JS -->
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-grid" style="margin-bottom: 1rem;">
                                        <div class="form-group" style="margin-bottom: 1rem;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(0,0,0,0.1); padding: 0.5rem; border-radius: 4px;"
                                                onclick="toggleListVisibility('rotina-responsavel-grid', 'icon-resp')">
                                                <label style="margin: 0; cursor: pointer;">Respons√°veis Pela
                                                    Rotina</label>
                                                <i class="fa-solid fa-chevron-down" id="icon-resp"></i>
                                            </div>
                                            <div id="rotina-responsavel-grid" class="form-grid"
                                                style="gap: 0.5rem; margin-top: 0.5rem; max-height: 150px; overflow-y: auto; padding: 0.5rem; background: rgba(0,0,0,0.05); border-radius: 4px; grid-template-columns: 1fr; display: none;">
                                                <!-- Checkboxes injetados pelo app.js -->
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label id="label-rotina-prazo">Dia Vencimento Padr√£o (1 a 31)</label>
                                            <input type="text" id="rotina-prazo" required class="glass-input"
                                                placeholder="Ex: 15">
                                        </div>
                                    </div>
                                    <div class="form-group" style="margin-top: 1.5rem;">
                                        <label>Itens do Checklist Padr√£o</label>
                                        <div style="display:flex; gap:0.5rem; margin-bottom:0.8rem;">
                                            <input type="text" id="new-checklist-item" class="glass-input"
                                                placeholder="Ex: Baixar XML">
                                            <button type="button" class="btn btn-secondary" id="btn-add-checklist-item"
                                                style="padding: 0 1rem;"><i class="fa-solid fa-plus"></i></button>
                                        </div>
                                        <ul id="rotina-checklist-preview"
                                            style="list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:0.4rem; max-height: 200px; overflow-y: auto;">
                                            <!-- Injetado por JS -->
                                        </ul>
                                    </div>
                                </div>

                                <!-- Coluna Direita: Clientes Vinculados -->
                                <div
                                    style="background: rgba(0,0,0,0.1); padding: 1.5rem; border-radius: var(--radius-md); border: 1px solid var(--border-glass);">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; cursor: pointer;"
                                        onclick="toggleListVisibility('clientes-checkbox-grid', 'icon-cli')">
                                        <h3 style="margin: 0; color: var(--text-main); font-size: 1.1rem;"><i
                                                class="fa-solid fa-users"></i> Clientes Vinculados</h3>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <div style="display: flex; align-items: center; gap: 0.5rem; justify-content: flex-end;"
                                                onclick="event.stopPropagation()">
                                                <!-- Ordena√ß√£o de Clientes na Rotina -->
                                                <select id="sort-clientes-rotina" class="glass-select"
                                                    style="height: 32px; padding: 0 0.5rem; font-size: 0.75rem; min-width: 100px;">
                                                    <option value="az">A ‚Üí Z</option>
                                                    <option value="za">Z ‚Üí A</option>
                                                    <option value="regime">Por Regime</option>
                                                </select>
                                                <input type="text" id="filter-clientes-rotina"
                                                    placeholder="Buscar cliente..." class="glass-input"
                                                    style="width: 0; opacity: 0; padding: 0; border: none; height: 32px; transition: all 0.3s ease-in-out; pointer-events: none;">
                                                <button type="button" class="btn btn-secondary"
                                                    id="btn-toggle-client-search" title="Buscar Clientes"
                                                    style="padding: 0; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                                    <i class="fa-solid fa-magnifying-glass"></i>
                                                </button>
                                            </div>
                                            <i class="fa-solid fa-chevron-up" id="icon-cli"></i>
                                        </div>
                                    </div>
                                    <p
                                        style="font-weight:400; font-size:0.85rem; color:var(--text-muted); margin-bottom: 1rem;">
                                        Marque os clientes que devem realizar esta rotina.</p>
                                    <div class="form-group">
                                        <div id="clientes-checkbox-grid" class="form-grid"
                                            style="gap: 0.8rem; grid-template-columns: 1fr; margin-top: 0.5rem; max-height: 400px; overflow-y: auto; padding: 0.5rem; display: grid;">
                                            <!-- Checkboxes injetados pelo app.js -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Caixa de Mensagens View (Redesign Refinado Estilo InMail) -->
            <div id="view-mensagens" class="view-section"
                style="display: none; height: calc(100vh - var(--topbar-height)); overflow: hidden; padding: 0;">
                <div class="inbox-container-premium inmail-refined">
                    <!-- Coluna 1: Navega√ß√£o/Sidebar -->
                    <aside class="inbox-nav-panel">
                        <div class="nav-panel-top">
                            <button class="btn btn-primary btn-compose-refined" id="btn-nova-mensagem">
                                <i class="fa-solid fa-pencil"></i> Nova Mensagem
                            </button>
                        </div>

                        <div class="nav-groups-wrapper">
                            <div class="nav-group">
                                <h4 class="nav-group-title">PRINCIPAL</h4>
                                <nav class="inbox-folders">
                                    <button class="folder-item active" data-folder="inbox">
                                        <div class="folder-label"><i class="fa-solid fa-inbox"></i> Entrada</div>
                                        <span class="folder-badge" id="inbox-unread-badge">0</span>
                                    </button>
                                    <button class="folder-item" data-folder="important">
                                        <div class="folder-label"><i class="fa-regular fa-star"></i> Favoritas</div>
                                    </button>
                                    <button class="folder-item" data-folder="sent">
                                        <div class="folder-label"><i class="fa-solid fa-paper-plane"></i> Enviadas
                                        </div>
                                    </button>
                                    <button class="folder-item" data-folder="system">
                                        <div class="folder-label"><i class="fa-solid fa-shield-halved"></i> Sistema
                                        </div>
                                        <span class="folder-badge system" id="system-unread-badge"
                                            style="display:none;">0</span>
                                    </button>
                                    <button class="folder-item" data-folder="trash">
                                        <div class="folder-label"><i class="fa-solid fa-trash-can"></i> Lixeira
                                        </div>
                                    </button>
                                </nav>
                            </div>

                            <div class="nav-group">
                                <div class="nav-group-header">
                                    <h4 class="nav-group-title">MINHAS PASTAS</h4>
                                    <button class="btn-add-folder-mini"><i class="fa-solid fa-plus"></i></button>
                                </div>
                                <nav class="inbox-folders">
                                    <button class="folder-item" data-folder="office">
                                        <div class="folder-label"><i class="fa-solid fa-folder"
                                                style="color: #6366f1;"></i> Escrit√≥rio</div>
                                    </button>
                                    <button class="folder-item" data-folder="clients">
                                        <div class="folder-label"><i class="fa-solid fa-folder"
                                                style="color: #f59e0b;"></i> Clientes</div>
                                    </button>
                                </nav>
                            </div>
                        </div>

                        <div class="nav-panel-bottom">
                            <button class="nav-bottom-item" id="btn-inbox-config"><i class="fa-solid fa-gear"></i>
                                Configura√ß√µes</button>
                            <button class="nav-bottom-item" id="btn-inbox-help"><i
                                    class="fa-solid fa-circle-question"></i> Ajuda</button>
                        </div>
                    </aside>

                    <!-- Coluna 2: Lista de Mensagens -->
                    <section class="inbox-list-panel">
                        <div class="list-panel-header">
                            <div class="list-controls-top">
                                <div class="checkbox-wrapper-all">
                                    <input type="checkbox" id="select-all-msgs">
                                    <i class="fa-solid fa-chevron-down"></i>
                                </div>
                                <div class="list-actions-minimal">
                                    <button title="Atualizar" id="btn-refresh-inbox-new"><i
                                            class="fa-solid fa-rotate-right"></i></button>
                                    <button title="Excluir Selecionados" id="btn-bulk-delete-msgs"
                                        style="display:none; color: #ef4444;"><i
                                            class="fa-solid fa-trash-can"></i></button>
                                    <button title="Marcar como lidas" id="btn-bulk-read-msgs" style="display:none;"><i
                                            class="fa-solid fa-envelope-open"></i></button>
                                    <button title="Mais op√ß√µes"><i class="fa-solid fa-ellipsis-vertical"></i></button>
                                </div>
                                <div class="list-pagination-minimal">
                                    <span id="msgs-count-info">...</span>
                                    <div class="pagination-arrows">
                                        <button class="prev-page"><i class="fa-solid fa-chevron-left"></i></button>
                                        <button class="next-page"><i class="fa-solid fa-chevron-right"></i></button>
                                    </div>
                                </div>
                            </div>
                            <div class="inbox-list-search-refined">
                                <div class="search-wrapper-refined">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                    <input type="text" id="msg-search-input" placeholder="Buscar mensagens..."
                                        oninput="handleMessageSearch(this.value)">
                                </div>
                            </div>
                        </div>
                        <div id="mensagens-container" class="inbox-items-scroll-refined">
                            <!-- Injetado via JS -->
                        </div>
                    </section>

                    <!-- Coluna 3: Leitor de Mensagem -->
                    <main class="inbox-reader-panel" id="inbox-reader">
                        <div class="empty-reader-state">
                            <div class="bottle-animation">
                                <i class="fa-solid fa-envelope-open-text"></i>
                            </div>
                            <h3>Nenhuma conversa selecionada</h3>
                            <p>Escolha uma mensagem na lista para ler</p>
                        </div>

                        <div class="reader-content-refined fade-in" style="display: none;">
                            <header class="reader-header-toolbar">
                                <div class="toolbar-left">
                                    <button class="toolbar-btn" id="btn-back-to-list" style="display: none;"><i
                                            class="fa-solid fa-arrow-left"></i></button>
                                    <button class="toolbar-btn" title="Arquivar"><i
                                            class="fa-solid fa-box-archive"></i></button>
                                    <button class="toolbar-btn" title="Spam"><i
                                            class="fa-solid fa-circle-exclamation"></i></button>
                                    <button class="toolbar-btn delete-refined" id="btn-delete-msg" title="Excluir"><i
                                            class="fa-solid fa-trash"></i></button>
                                </div>
                                <div class="toolbar-right">
                                    <button class="toolbar-btn" title="Mover para"><i
                                            class="fa-solid fa-folder-open"></i></button>
                                    <button class="toolbar-btn" title="Etiquetas"><i
                                            class="fa-solid fa-tag"></i></button>
                                    <button class="toolbar-btn" title="Mais"><i
                                            class="fa-solid fa-ellipsis-vertical"></i></button>
                                </div>
                            </header>

                            <div class="reader-body-scroll-refined">
                                <div class="reader-msg-header">
                                    <h2 id="reader-subject">Assunto da Mensagem</h2>
                                    <div class="reader-user-info">
                                        <div class="reader-avatar-large" id="reader-avatar-text">?</div>
                                        <div class="reader-meta-group">
                                            <div class="reader-sender-row">
                                                <strong id="reader-from">Nome do Usu√°rio</strong>
                                                <span class="reader-email-minimal"
                                                    id="reader-email-text">usu√°rio@fiscal.app</span>
                                                <span class="reader-time-badge" id="reader-date">10:30 AM</span>
                                            </div>
                                            <div class="reader-dest-row">
                                                <span>para mim</span> <i class="fa-solid fa-caret-down"></i>
                                            </div>
                                        </div>
                                        <div class="reader-msg-actions">
                                            <button class="btn-reply-minimal" id="btn-reply-msg"><i
                                                    class="fa-solid fa-reply"></i> Responder</button>
                                            <button class="btn-icon-minimal"><i class="fa-solid fa-star"></i></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="reader-msg-body" id="reader-body-content">
                                    <!-- Conte√∫do injetado -->
                                </div>
                                <div class="reader-reply-placeholder">
                                    <div class="reply-box-mini">
                                        <span>Clique aqui para <button class="link-btn">Responder</button> ou
                                            <button class="link-btn">Encaminhar</button></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

            <div id="view-settings" class="view-section" style="display: none;">
                <header class="section-header">
                    <div>
                        <h1><i class="fa-solid fa-gear highlight-text"></i> Painel de Controle</h1>
                        <p class="subtitle">Gerencie as configura√ß√µes e acessos do sistema</p>
                    </div>
                </header>

                <div class="settings-layout-modern">
                    <!-- Barra Lateral de Configura√ß√µes Internas -->
                    <aside class="settings-sidebar-mini">
                        <nav class="settings-nav-list">
                            <div class="settings-nav-group">Sistema</div>
                            <button class="settings-tab-btn active" data-target="set-rbac">
                                <i class="fa-solid fa-shield-halved"></i>
                                <span>Seguran√ßa e Acessos</span>
                            </button>
                            <button class="settings-tab-btn" data-target="set-equipe">
                                <i class="fa-solid fa-users"></i>
                                <span>Contas e Equipe</span>
                            </button>
                            <button class="settings-tab-btn" data-target="set-backup">
                                <i class="fa-solid fa-cloud-arrow-down"></i>
                                <span>Backups</span>
                            </button>

                            <div class="settings-nav-group">Par√¢metros Mestre</div>
                            <button class="settings-tab-btn" data-target="set-feriados">
                                <i class="fa-solid fa-calendar-day"></i>
                                <span>Dias √öteis e Feriados</span>
                            </button>
                            <button class="settings-tab-btn" data-target="set-notificacoes">
                                <i class="fa-solid fa-bell-concierge"></i>
                                <span>Avisos e Notifica√ß√µes</span>
                            </button>

                            <div class="settings-nav-group">Auditoria</div>
                            <button class="settings-tab-btn" data-target="set-auditoria">
                                <i class="fa-solid fa-clipboard-list"></i>
                                <span>Logs de Atividade</span>
                            </button>
                            <button class="settings-tab-btn" data-target="set-auditoria-comp">
                                <i class="fa-solid fa-magnifying-glass-chart"></i>
                                <span>Auditoria Entregas</span>
                            </button>

                            <div class="settings-nav-group">Personaliza√ß√£o</div>
                            <button class="settings-tab-btn" data-target="set-branding">
                                <i class="fa-solid fa-palette"></i>
                                <span>Layout e Ordem</span>
                            </button>
                        </nav>
                    </aside>

                    <!-- √Årea de Conte√∫do Direito de Configura√ß√µes -->
                    <div class="settings-content-area">

                        <!-- ABA: Seguran√ßa / Cargos / RBAC -->
                        <div class="settings-pane active fade-in" id="set-rbac">
                            <div class="settings-action-header">
                                <div>
                                    <h2 style="font-size: 1.25rem;">Cargos e Permiss√µes</h2>
                                    <p style="color: var(--text-muted); font-size: 0.9rem;">Crie perfis e defina quais
                                        telas eles podem ver.</p>
                                </div>
                                <button class="btn btn-primary" id="btn-add-cargo">
                                    <i class="fa-solid fa-shield-plus"></i> Novo Cargo
                                </button>
                            </div>
                            <div class="glass-card full-table-container">
                                <div class="table-responsive">
                                    <table class="data-table" id="admin-cargos-table">
                                        <thead>
                                            <tr>
                                                <th>C√≥d.</th>
                                                <th>Nome do Cargo</th>
                                                <th>Telas Permitidas</th>
                                                <th style="text-align: right;">A√ß√µes</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Preenchido pelo JS -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- ABA: Gest√£o de Equipe -->
                        <div class="settings-pane fade-in" id="set-equipe" style="display: none;">
                            <div class="settings-action-header">
                                <div>
                                    <h2 style="font-size: 1.25rem;">Gest√£o de Contas (Equipe)</h2>
                                    <p style="color: var(--text-muted); font-size: 0.9rem;">Crie, inative e edite
                                        funcion√°rios do sistema.</p>
                                </div>
                                <button class="btn btn-primary" id="btn-add-equipe">
                                    <i class="fa-solid fa-user-plus"></i> Nova Conta
                                </button>
                            </div>

                            <div class="settings-grid-3" style="margin-bottom: 1.5rem;">
                                <div class="glass-card kpi-card" style="padding: 1rem;">
                                    <div class="kpi-icon"
                                        style="background: rgba(99, 102, 241, 0.15); color: var(--primary); font-size: 1.2rem; width: 40px; height: 40px;">
                                        <i class="fa-solid fa-users-viewfinder"></i>
                                    </div>
                                    <div class="kpi-data">
                                        <h3 style="font-size: 0.8rem;">Total Equipe</h3>
                                        <p class="kpi-value" id="kpi-total-equipe" style="font-size: 1.5rem;">0</p>
                                    </div>
                                </div>
                                <div class="glass-card kpi-card status-success" style="padding: 1rem;">
                                    <div class="kpi-icon" style="font-size: 1.2rem; width: 40px; height: 40px;"><i
                                            class="fa-solid fa-user-check"></i></div>
                                    <div class="kpi-data">
                                        <h3 style="font-size: 0.8rem;">Contas Ativas</h3>
                                        <p class="kpi-value" id="kpi-equipe-ativos" style="font-size: 1.5rem;">0</p>
                                    </div>
                                </div>
                                <div class="glass-card kpi-card status-danger" style="padding: 1rem;">
                                    <div class="kpi-icon" style="font-size: 1.2rem; width: 40px; height: 40px;"><i
                                            class="fa-solid fa-user-xmark"></i></div>
                                    <div class="kpi-data">
                                        <h3 style="font-size: 0.8rem;">Contas Inativas</h3>
                                        <p class="kpi-value" id="kpi-equipe-inativos" style="font-size: 1.5rem;">0</p>
                                    </div>
                                </div>
                            </div>

                            <div class="glass-card full-table-container">
                                <div class="table-responsive">
                                    <table class="data-table" id="equipe-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nome</th>
                                                <th>Setor</th>
                                                <th>Permiss√£o (Perfil)</th>
                                                <th>Status</th>
                                                <th style="text-align: right;">A√ß√µes</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Preenchido pelo JS -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>


                        <!-- ABA: Backup -->
                        <div class="settings-pane fade-in" id="set-backup" style="display: none;">
                            <div style="margin-bottom: 1.5rem;">
                                <h2 style="font-size: 1.25rem;">Backup e Recupera√ß√£o</h2>
                                <p style="color: var(--text-muted); font-size: 0.9rem;">Garanta a seguran√ßa dos seus
                                    dados realizando c√≥pias locais.</p>
                            </div>
                            <div class="settings-grid-2">
                                <div class="glass-card table-container">
                                    <h3 style="margin-bottom: 1rem; color: var(--primary);"><i
                                            class="fa-solid fa-download"></i>
                                        Fazer Backup</h3>
                                    <p
                                        style="color: var(--text-muted); font-size: 0.9em; margin-bottom: 1.5rem; line-height: 1.5;">
                                        Fa√ßa o download de um arquivo ".json" contendo 100% dos dados atuais do
                                        sistema.
                                    </p>
                                    <button class="btn btn-primary" id="btn-export-backup" style="width: 100%;"><i
                                            class="fa-solid fa-file-export"></i> Baixar Base de Dados Agora</button>
                                    <div
                                        style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; align-items: center;">
                                        <label>Lembrete de Auto-Backup</label>
                                        <label class="switch"><input type="checkbox" id="toggle-auto-backup"><span
                                                class="slider round"></span></label>
                                    </div>
                                    <p style="margin-top: 0.5rem; font-size: 0.8em; color: var(--text-muted); text-align: right;"
                                        id="last-backup-text">√öltimo: Nunca</p>
                                </div>
                                <div class="glass-card table-container"
                                    style="border: 1px solid rgba(239, 68, 68, 0.3);">
                                    <h3 style="margin-bottom: 1rem; color: var(--danger);"><i
                                            class="fa-solid fa-upload"></i>
                                        Restaurar Sistema</h3>
                                    <p
                                        style="color: var(--text-muted); font-size: 0.9em; margin-bottom: 1.5rem; line-height: 1.5;">
                                        Suba um backup anterior (isto apagar√° os dados atuais do momento).</p>
                                    <input type="file" id="backup-file-input" accept=".json" class="glass-input"
                                        style="padding: 0.5rem; margin-bottom: 1rem; width: 100%;">
                                    <button class="btn btn-primary" id="btn-restore-backup"
                                        style="width: 100%; background: var(--danger);"><i
                                            class="fa-solid fa-rotate-left"></i>
                                        Esmagar Base Atual e Restaurar</button>
                                </div>
                            </div>
                        </div>

                        <!-- ABA: Logs Auditoria Geral -->
                        <div class="settings-pane fade-in" id="set-auditoria" style="display: none;">
                            <div class="settings-action-header">
                                <div>
                                    <h2 style="font-size: 1.25rem;">Auditoria de Sistema (Logs)</h2>
                                    <p style="color: var(--text-muted); font-size: 0.9rem;">Rastreador de acessos,
                                        exclus√µes e modifica√ß√µes globais na base.</p>
                                </div>
                                <button class="btn btn-secondary" id="btn-export-logs">
                                    <i class="fa-solid fa-file-csv"></i> Exportar CSV
                                </button>
                            </div>
                            <div class="glass-card full-table-container">
                                <div class="table-responsive">
                                    <table class="data-table" id="auditoria-table">
                                        <thead>
                                            <tr>
                                                <th>Data / Hora</th>
                                                <th>Usu√°rio</th>
                                                <th>Permiss√£o</th>
                                                <th>A√ß√£o Registrada</th>
                                                <th>Detalhes Adicionais</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Preenchido pelo JS -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- ABA: Auditoria de Compet√™ncia O FOCO DA ENTREGA -->
                        <div class="settings-pane fade-in" id="set-auditoria-comp" style="display: none;">
                            <div style="margin-bottom: 1.5rem;">
                                <h2 style="font-size: 1.25rem;">Auditoria de Compet√™ncia (Hist√≥rico Fiel)</h2>
                                <p style="color: var(--text-muted); font-size: 0.9rem;">Volte no tempo e descubra
                                    como
                                    foi o desempenho de um funcion√°rio em um m√™s espec√≠fico (Data exata de baixa, se
                                    quebrou o prazo, etc).</p>
                            </div>
                            <div class="glass-card table-container" style="margin-bottom: 1rem; padding: 1.5rem;">
                                <div class="settings-grid-3" style="align-items: end;">
                                    <div class="form-group" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <label
                                            style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500; margin: 0;">M√™s
                                            de Compet√™ncia</label>
                                        <select id="audit-comp-mes" class="glass-select"
                                            style="width: 100%; height: 46px;"></select>
                                    </div>
                                    <div class="form-group" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <label
                                            style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500; margin: 0;">Funcion√°rio</label>
                                        <select id="audit-comp-user" class="glass-select"
                                            style="width: 100%; height: 46px;"></select>
                                    </div>
                                    <div>
                                        <button class="btn btn-primary" id="btn-run-audit-comp"
                                            style="height: 46px; width: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--primary-light), var(--accent)); border: none; font-weight: 600; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3); transition: all 0.3s ease; gap: 0.5rem;">
                                            <i class="fa-solid fa-magnifying-glass"></i> <span>Auditar</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Resultados da Auditoria de Compet√™ncia -->
                            <div class="glass-card full-table-container" id="audit-comp-results"
                                style="display: none; padding-bottom: 2rem;">
                                <div class="settings-action-header" style="padding: 1.5rem 2rem;">
                                    <div>
                                        <h3
                                            style="margin:0; font-size: 1.25rem; font-weight: 700; color: var(--primary-light); letter-spacing: -0.02em;">
                                            <i class="fa-solid fa-file-contract"
                                                style="margin-right: 0.5rem; opacity: 0.8;"></i> Relat√≥rio Fiel de
                                            Baixas
                                        </h3>
                                        <p id="audit-comp-subtitle"
                                            style="margin:0.25rem 0 0; font-size: 0.9rem; color: var(--text-muted);">
                                        </p>
                                    </div>
                                    <button class="btn btn-secondary no-print" id="btn-print-audit-comp"
                                        style="display: flex; align-items: center; gap: 0.5rem; background: rgba(255,255,255,0.05); border: 1px solid var(--border-glass);">
                                        <i class="fa-solid fa-print"></i> <span>Imprimir</span>
                                    </button>
                                </div>

                                <!-- Grid de KPIs Moderno -->
                                <div class="settings-grid-3" style="padding: 0 2rem 2rem;">
                                    <div class="kpi-card-mini"
                                        style="background: rgba(16, 185, 129, 0.1); border-left: 4px solid #10b981; padding: 1rem; border-radius: 8px;">
                                        <div
                                            style="font-size: 0.75rem; color: #10b981; font-weight: 600; text-transform: uppercase;">
                                            No Prazo</div>
                                        <div id="audit-comp-noprazo"
                                            style="font-size: 1.75rem; font-weight: 800; color: #10b981;">0</div>
                                    </div>
                                    <div class="kpi-card-mini"
                                        style="background: rgba(239, 68, 68, 0.1); border-left: 4px solid #ef4444; padding: 1rem; border-radius: 8px;">
                                        <div
                                            style="font-size: 0.75rem; color: #ef4444; font-weight: 600; text-transform: uppercase;">
                                            Atrasados</div>
                                        <div id="audit-comp-atrasado"
                                            style="font-size: 1.75rem; font-weight: 800; color: #ef4444;">0</div>
                                    </div>
                                    <div class="kpi-card-mini"
                                        style="background: rgba(245, 158, 11, 0.1); border-left: 4px solid #f59e0b; padding: 1rem; border-radius: 8px;">
                                        <div
                                            style="font-size: 0.75rem; color: #f59e0b; font-weight: 600; text-transform: uppercase;">
                                            Pendentes</div>
                                        <div id="audit-comp-pendente"
                                            style="font-size: 1.75rem; font-weight: 800; color: #f59e0b;">0</div>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="data-table" id="audit-comp-table">
                                        <thead>
                                            <tr>
                                                <th>Cliente</th>
                                                <th>Rotina Auditada</th>
                                                <th>Prazo Original (Deadline)</th>
                                                <th>Data Real da Baixa</th>
                                                <th>Veredito (Status do M√™s)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Preenchido dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- ABA: Prazos e Feriados (Nova Conf) -->
                        <div class="settings-pane fade-in" id="set-feriados" style="display: none;">
                            <div class="settings-action-header" style="margin-bottom: 2rem;">
                                <div>
                                    <h2 style="font-size: 1.25rem;"><i
                                            class="fa-solid fa-calendar-day highlight-text"></i> Dias √öteis e Feriados
                                    </h2>
                                    <p style="color: var(--text-muted); font-size: 0.9rem;">Configure os dias de
                                        expediente para o c√°lculo exato dos prazos de rotinas.</p>
                                </div>
                            </div>
                            <div class="glass-card" style="padding: 3rem; text-align: center;">
                                <i class="fa-solid fa-person-digging"
                                    style="font-size: 3rem; color: var(--primary); margin-bottom: 1rem; opacity: 0.5;"></i>
                                <h3>M√≥dulo em Desenvolvimento</h3>
                                <p style="color: var(--text-muted); max-width: 400px; margin: 1rem auto;">A intelig√™ncia
                                    de c√°lculo de dias √∫teis e integra√ß√£o com feriados nacionais ser√° liberada na
                                    pr√≥xima atualiza√ß√£o fiscal.</p>
                            </div>
                        </div>

                        <!-- ABA: Notifica√ß√µes (Nova Conf) -->
                        <div class="settings-pane fade-in" id="set-notificacoes" style="display: none;">
                            <div class="settings-action-header" style="margin-bottom: 2rem;">
                                <div>
                                    <h2 style="font-size: 1.25rem;"><i
                                            class="fa-solid fa-bell-concierge highlight-text"></i> Alertas e
                                        Notifica√ß√µes</h2>
                                    <p style="color: var(--text-muted); font-size: 0.9rem;">Configure como o sistema
                                        avisa sua equipe sobre prazos cr√≠ticos e tarefas pendentes.</p>
                                </div>
                            </div>
                            <div class="glass-card" style="padding: 2rem;">
                                <div class="form-group"
                                    style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 1rem;">
                                    <div>
                                        <strong>Alerta de Tarefas Vencendo</strong>
                                        <p style="font-size: 0.8rem; color: var(--text-muted);">Avisar com anteced√™ncia
                                            de X dias</p>
                                    </div>
                                    <select class="glass-select" style="width: 150px;">
                                        <option>2 dias antes</option>
                                        <option selected>3 dias antes</option>
                                        <option>5 dias antes</option>
                                    </select>
                                </div>
                                <div class="form-group"
                                    style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); padding: 1rem 0;">
                                    <div>
                                        <strong>Resumo Semanal por E-mail</strong>
                                        <p style="font-size: 0.8rem; color: var(--text-muted);">Enviar estat√≠sticas para
                                            os gestores √†s segundas</p>
                                    </div>
                                    <label class="switch"><input type="checkbox" checked><span
                                            class="slider round"></span></label>
                                </div>
                                <div class="form-group"
                                    style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem;">
                                    <div>
                                        <strong>For√ßar Aviso de Backup</strong>
                                        <p style="font-size: 0.8rem; color: var(--text-muted);">Notificar admin se ficar
                                            7 dias sem backup</p>
                                    </div>
                                    <label class="switch"><input type="checkbox" checked><span
                                            class="slider round"></span></label>
                                </div>
                                <div style="margin-top: 2rem; text-align: right;">
                                    <button class="btn btn-primary"
                                        onclick="showFeedbackToast('Configura√ß√µes salvas!', 'success')">Salvar
                                        Prefer√™ncias</button>
                                </div>
                            </div>
                        </div>

                        <!-- ABA: Personaliza√ß√£o / Branding -->
                        <div class="settings-pane fade-in" id="set-branding" style="display: none;">
                            <div style="margin-bottom: 2rem;">
                                <h2 style="font-size: 1.25rem;">Personaliza√ß√£o da Marca</h2>
                                <p style="color: var(--text-muted); font-size: 0.9rem;">Altere o nome e a identidade
                                    visual do seu portal.</p>
                            </div>

                            <div class="glass-card" style="max-width: 600px; padding: 2rem;">
                                <form id="form-branding">
                                    <div class="settings-grid-2" style="margin-bottom: 1.5rem;">
                                        <div class="form-group">
                                            <label>Nome da Empresa</label>
                                            <input type="text" id="brand-name" class="glass-input"
                                                placeholder="Ex: RB Contabilidade">
                                        </div>
                                        <div class="form-group">
                                            <label>Slogan / Subt√≠tulo</label>
                                            <input type="text" id="brand-slogan" class="glass-input"
                                                placeholder="Ex: Intelig√™ncia em Gest√£o">
                                        </div>
                                    </div>

                                    <div class="settings-grid-2" style="margin-bottom: 1.5rem;">
                                        <div class="form-group">
                                            <label>Tema de Sistema</label>
                                            <select id="brand-theme" class="glass-select" style="width: 100%;">
                                                <option value="glass">Premium Glassmorphism</option>
                                                <option value="dark">Deep Night (Escuro S√≥lido)</option>
                                                <option value="light">Soft Day (Claro Elegante)</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>Cor de Destaque</label>
                                            <div style="display: flex; gap: 10px; align-items: center;">
                                                <input type="color" id="brand-accent-color" class="glass-input"
                                                    style="width: 50px; height: 46px; padding: 5px; cursor: pointer;">
                                                <span style="font-size: 0.8rem; opacity: 0.7;">Prim√°ria Sistema</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group" style="margin-bottom: 2rem;">
                                        <label>URL da Logomarca (PNG transparente recomendado)</label>
                                        <input type="text" id="brand-logo-url" class="glass-input"
                                            placeholder="https://exemplo.com/logo.png">
                                        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 5px;">A logo
                                            ser√° exibida na tela de login e opcionalmente no dashboard.</p>
                                    </div>

                                    <button class="btn btn-primary" type="submit" style="width: 100%; height: 50px;">
                                        <i class="fa-solid fa-wand-magic-sparkles"></i> Aplicar Identidade Visual
                                    </button>
                                </form>
                            </div>

                            <div class="glass-card" style="max-width: 600px; padding: 2rem; margin-top: 2rem;">
                                <h3 style="font-size: 1.1rem; margin-bottom: 1rem;"><i
                                        class="fa-solid fa-grip-lines"></i> Ordem do Menu Lateral</h3>
                                <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 1.5rem;">Arraste
                                    os itens para definir a ordem de exibi√ß√£o no menu lateral.</p>

                                <div id="menu-reorder-list" class="reorder-list">
                                    <!-- Populada por JS -->
                                </div>

                                <div style="display: flex; justify-content: flex-end; margin-top: 1.5rem;">
                                    <button class="btn btn-primary btn-small" onclick="saveMenuOrder()"
                                        id="btn-save-menu-order">
                                        <i class="fa-solid fa-floppy-disk btn-save-anim"></i> Salvar
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div> <!-- Fim dos Pain√©is de Conte√∫do de Configura√ß√µes -->
                </div> <!-- Fim do Layout de Configura√ß√µes -->
            </div>

        </main>
    </div>

    <!-- Modal de Detalhes e Checklist -->
    <div class="modal-overlay" id="task-modal">
        <div class="glass-card modal-content">
            <header class="modal-header">
                <h2>Rotina: <span id="modal-rotina-name" class="highlight-text"></span></h2>
                <button class="close-btn" id="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </header>

            <div class="modal-body">
                <div class="task-info-grid">
                    <div class="info-group">
                        <label>Cliente</label>
                        <p id="modal-cliente"></p>
                    </div>
                    <div class="info-group">
                        <label>Prazo de Entrega</label>
                        <p id="modal-prazo"></p>
                    </div>
                    <div class="info-group">
                        <label>Status Sistema</label>
                        <p id="modal-status"></p>
                    </div>
                </div>

                <div class="checklist-section">
                    <div class="checklist-header">
                        <h3><i class="fa-solid fa-list-check"></i> Checklist Operacional Autom√°tico</h3>
                        <span class="progress-text" id="modal-progress-text">0% Conclu√≠do</span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="modal-progress" style="width: 0%"></div>
                    </div>
                    <div class="checklist-items" id="modal-checklist">
                        <!-- Preenchido pelo JS -->
                    </div>
                </div>

                <div class="actions-section">
                    <label class="custom-toggle">
                        <input type="checkbox" id="modal-done-toggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">Marcar Rotina como Feita</span>
                    </label>
                </div>
            </div>

            <footer class="modal-footer">
                <button class="btn btn-secondary" id="modal-cancel">Sair</button>
                <button class="btn btn-primary" id="modal-save">Salvar Altera√ß√µes</button>
            </footer>
        </div>
    </div>

    <!-- Detalhes do cliente movidos para painel na tela principal -->

    <!-- Modal Adicionar Funcion√°rio -->
    <div class="modal-overlay" id="add-equipe-modal">
        <div class="glass-card modal-content" style="max-width: 400px;">
            <header class="modal-header">
                <h2 id="modal-equipe-title"><i class="fa-solid fa-user-shield highlight-text"></i> Novo Funcion√°rio</h2>
                <button class="close-btn" id="close-equipe-modal"><i class="fa-solid fa-xmark"></i></button>
            </header>

            <div class="modal-body" style="padding-bottom: 0;">
                <form id="add-equipe-form">
                    <input type="hidden" id="equipe-id" value="">
                    <div class="form-group" id="equipe-status-container" style="margin-bottom: 1rem;">
                        <label class="custom-toggle">
                            <input type="checkbox" id="equipe-ativo" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-label" style="display: flex; align-items: center; gap: 8px;">
                                Status: <span id="equipe-status-badge" class="table-badge success"><i
                                        class="fa-solid fa-circle-check"></i> Ativo</span>
                            </span>
                        </label>
                    </div>
                    <div id="equipe-error"
                        style="display: none; color: var(--danger); font-size: 0.85rem; margin-bottom: 1rem; padding: 0.5rem; background: var(--danger-bg); border-radius: var(--radius-sm); border: 1px solid var(--danger);">
                    </div>
                    <div class="form-group">
                        <label>Nome Completo</label>
                        <input type="text" id="equipe-nome" required class="glass-input" placeholder="Ex: Jo√£o Silva">
                    </div>
                    <div class="form-group">
                        <label>Setor Principal</label>
                        <select id="equipe-setor" class="glass-select" style="width: 100%;">
                            <!-- Preenchido dinamicamente via JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Cargo / Fun√ß√£o</label>
                        <select id="equipe-cargo" class="glass-select" style="width: 100%;">
                            <option value="">Nenhum cargo vinculado</option>
                            <!-- Preenchido via JS -->
                        </select>
                        <small style="color: var(--text-muted); font-size: 0.75rem; display: block; margin-top: 4px;">As
                            permiss√µes ser√£o herdadas do cargo selecionado.</small>
                    </div>
                    <div class="form-group">
                        <label>N√≠vel de Acesso (Base)</label>
                        <select id="equipe-permissao" class="glass-select" style="width: 100%;">
                            <option value="Operacional">Operacional (Tarefa Pr√≥pria)</option>
                            <option value="Supervisor">Supervisor (Visualiza Equipe)</option>
                            <option value="Gerente">Gerente (Acesso Administrativo)</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-top: 1rem;">
                        <label>Senha de Acesso</label>
                        <input type="password" id="equipe-senha" required class="glass-input" placeholder="Ex: 123">
                    </div>
                </form>
            </div>

            <footer class="modal-footer" style="justify-content: space-between;">
                <div>
                    <button type="button" class="btn btn-outline" id="btn-delete-equipe"
                        style="display: none; border-color: var(--danger); color: var(--danger);">
                        <i class="fa-solid fa-trash-can"></i> Excluir Conta
                    </button>
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <button type="button" class="btn btn-secondary" id="equipe-modal-cancel">Cancelar</button>
                    <button class="btn btn-primary" form="add-equipe-form" type="submit"
                        id="btn-save-equipe">Cadastrar</button>
                </div>
            </footer>
        </div>
    </div>

    <!-- Removido Modal Adicionar Rotina por usar tela cheia -->

    <!-- Modal Nova Mensagem -->
    <div class="modal-overlay" id="nova-mensagem-modal">
        <div class="glass-card modal-content" style="max-width: 500px;">
            <header class="modal-header">
                <h2><i class="fa-solid fa-envelope highlight-text"></i> Enviar Mensagem</h2>
                <button class="close-btn" id="close-mensagem-modal"><i class="fa-solid fa-xmark"></i></button>
            </header>

            <div class="modal-body" style="padding-bottom: 0;">
                <form id="nova-mensagem-form">
                    <div class="form-group">
                        <label>Para (Destinat√°rio)</label>
                        <select id="msg-destinatario" class="glass-select" style="width: 100%;" required>
                            <!-- Preenchido pelo JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Assunto</label>
                        <input type="text" id="msg-assunto" class="glass-input" placeholder="Ex: D√∫vida sobre imposto"
                            required>
                    </div>
                    <div class="form-group">
                        <label>Mensagem</label>
                        <textarea id="msg-texto" required class="glass-input" rows="4"
                            placeholder="Escreva seu recado aqui..."></textarea>
                    </div>
                </form>
            </div>

            <footer class="modal-footer">
                <button class="btn btn-secondary" id="mensagem-modal-cancel">Cancelar</button>
                <button class="btn btn-primary" form="nova-mensagem-form" type="submit"><i
                        class="fa-solid fa-paper-plane"></i> Enviar</button>
            </footer>
        </div>
    </div>

    <!-- Manage Setores Modal -->
    <div class="modal-overlay" id="manage-setores-modal">
        <div class="glass-card modal-content" style="max-width: 400px;">
            <header class="modal-header">
                <h2><i class="fa-solid fa-list-ul highlight-text"></i> Gerenciar Setores</h2>
                <button class="close-btn" id="close-setores-modal"><i class="fa-solid fa-xmark"></i></button>
            </header>

            <div class="modal-body">
                <div class="form-group" style="margin-bottom: 1rem;">
                    <label>Adicionar Novo Setor</label>
                    <div style="display:flex; gap:0.5rem; margin-bottom:0.5rem;">
                        <input type="text" id="new-setor-name" class="glass-input" placeholder="Ex: Financeiro">
                        <button type="button" class="btn btn-primary" id="btn-add-setor-submit"
                            style="padding: 0 1rem;"><i class="fa-solid fa-plus"></i> Incluir</button>
                    </div>
                </div>

                <label>Setores Existentes no Sistema</label>
                <ul id="setores-list-preview"
                    style="list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:0.25rem; max-height: 200px; overflow-y: auto;">
                    <!-- Injetado por JS -->
                </ul>
            </div>

            <footer class="modal-footer">
                <button class="btn btn-secondary" id="setores-modal-close-btn">Fechar</button>
            </footer>
        </div>
    </div>

    <!-- Modal Cargo Admin (RBAC) -->
    <div class="modal-overlay" id="admin-cargo-modal">
        <div class="glass-card modal-content" style="max-width: 650px; width: 95%;">
            <header class="modal-header"
                style="border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 1rem; margin-bottom: 1.5rem;">
                <div>
                    <h2 style="font-size: 1.4rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span
                            style="background: rgba(99, 102, 241, 0.15); color: #818cf8; padding: 0.5rem; border-radius: 8px;"><i
                                class="fa-solid fa-shield-halved"></i></span>
                        Configura√ß√£o de Perfil de Acesso
                    </h2>
                    <p style="color: var(--text-muted); font-size: 0.85rem; margin-top: 0.2rem;">Defina as telas e
                        ferramentas que este cargo pode acessar.</p>
                </div>
                <button class="close-btn" id="close-cargo-modal"><i class="fa-solid fa-xmark"></i></button>
            </header>

            <div class="modal-body" style="padding-bottom: 0;">
                <form id="admin-cargo-form">
                    <input type="hidden" id="cargo-id">

                    <div class="form-group" style="margin-bottom: 2rem;">
                        <label
                            style="font-size: 0.9rem; font-weight: 500; color: #cbd5e1; margin-bottom: 0.5rem; display: block;"><i
                                class="fa-solid fa-tag" style="color: var(--primary); margin-right: 5px;"></i> Nome do
                            Cargo Comercial</label>
                        <input type="text" id="cargo-nome" class="glass-input" placeholder="Ex: Analista Fiscal S√™nior"
                            required style="font-size: 1.05rem; padding: 0.8rem 1rem;">
                    </div>

                    <div class="form-group">
                        <label
                            style="font-size: 0.9rem; font-weight: 500; color: #cbd5e1; margin-bottom: 1rem; display: block;"><i
                                class="fa-solid fa-key" style="color: var(--primary); margin-right: 5px;"></i> M√≥dulos
                            Permitidos</label>

                        <div id="cargo-permissions-list" class="permissions-premium-grid">

                            <!-- Grupo: Vis√£o Estrat√©gica -->
                            <div class="perm-group">
                                <h4 class="perm-group-title">Vis√£o Estrat√©gica</h4>
                                <label class="perm-card">
                                    <input type="checkbox" value="dashboard" class="cargo-perm-check">
                                    <div class="perm-card-content">
                                        <i class="fa-solid fa-gauge perm-icon"></i>
                                        <div class="perm-text">
                                            <span class="perm-name">Dashboard</span>
                                            <span class="perm-desc">Vis√£o macro e KPIs</span>
                                        </div>
                                    </div>
                                </label>
                                <label class="perm-card">
                                    <input type="checkbox" value="meu-desempenho" class="cargo-perm-check">
                                    <div class="perm-card-content">
                                        <i class="fa-solid fa-chart-pie perm-icon"></i>
                                        <div class="perm-text">
                                            <span class="perm-name">Meu Desempenho</span>
                                            <span class="perm-desc">Estat√≠sticas individuais</span>
                                        </div>
                                    </div>
                                </label>
                            </div>

                            <!-- Grupo: Opera√ß√£o Di√°ria -->
                            <div class="perm-group">
                                <h4 class="perm-group-title">Opera√ß√£o Di√°ria</h4>
                                <label class="perm-card">
                                    <input type="checkbox" value="operacional" class="cargo-perm-check">
                                    <div class="perm-card-content">
                                        <i class="fa-solid fa-list-check perm-icon"></i>
                                        <div class="perm-text">
                                            <span class="perm-name">Operacional</span>
                                            <span class="perm-desc">Baixa de rotinas</span>
                                        </div>
                                    </div>
                                </label>
                                <label class="perm-card">
                                    <input type="checkbox" value="mensagens" class="cargo-perm-check">
                                    <div class="perm-card-content">
                                        <i class="fa-solid fa-envelope perm-icon"></i>
                                        <div class="perm-text">
                                            <span class="perm-name">Mensagens</span>
                                            <span class="perm-desc">Correio interno</span>
                                        </div>
                                    </div>
                                </label>
                            </div>

                            <!-- Grupo: Cadastros Mestre (Mesclado Rotinas, Clientes, Equipe) -->
                            <div class="perm-group" style="grid-column: 1 / -1;">
                                <h4 class="perm-group-title">Cadastros Mestre</h4>
                                <div
                                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.8rem;">
                                    <label class="perm-card">
                                        <input type="checkbox" value="clientes" class="cargo-perm-check">
                                        <div class="perm-card-content">
                                            <i class="fa-solid fa-users perm-icon"></i>
                                            <div class="perm-text">
                                                <span class="perm-name">Clientes</span>
                                                <span class="perm-desc">Gest√£o de carteira</span>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="perm-card">
                                        <input type="checkbox" value="rotinas" class="cargo-perm-check">
                                        <div class="perm-card-content">
                                            <i class="fa-solid fa-layer-group perm-icon"></i>
                                            <div class="perm-text">
                                                <span class="perm-name">Rotinas Base</span>
                                                <span class="perm-desc">Matrizes de prazos</span>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="perm-card">
                                        <input type="checkbox" value="competencias" class="cargo-perm-check">
                                        <div class="perm-card-content">
                                            <i class="fa-solid fa-calendar-check perm-icon"></i>
                                            <div class="perm-text">
                                                <span class="perm-name">Compet√™ncias</span>
                                                <span class="perm-desc">Meses do sistema</span>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="perm-card">
                                        <input type="checkbox" value="marketing" class="cargo-perm-check">
                                        <div class="perm-card-content">
                                            <i class="fa-solid fa-bullhorn perm-icon"></i>
                                            <div class="perm-text">
                                                <span class="perm-name">Comunica√ß√£o</span>
                                                <span class="perm-desc">Marketing e avisos</span>
                                            </div>
                                        </div>
                                    </label>
                                    <label class="perm-card">
                                        <input type="checkbox" value="equipe" class="cargo-perm-check">
                                        <div class="perm-card-content">
                                            <i class="fa-solid fa-user-tie perm-icon"></i>
                                            <div class="perm-text">
                                                <span class="perm-name">Equipe</span>
                                                <span class="perm-desc">Gest√£o de analistas</span>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Grupo: Configura√ß√µes de Sistema -->
                            <div class="perm-group"
                                style="grid-column: 1 / -1; border-top: 1px dashed rgba(239, 68, 68, 0.3); padding-top: 1rem;">
                                <h4 class="perm-group-title" style="color: #ef4444;"><i
                                        class="fa-solid fa-triangle-exclamation" style="margin-right: 5px;"></i>
                                    Restrito (Admin)</h4>
                                <label class="perm-card danger-card">
                                    <input type="checkbox" value="settings" class="cargo-perm-check">
                                    <div class="perm-card-content">
                                        <i class="fa-solid fa-gears perm-icon" style="color: #ef4444;"></i>
                                        <div class="perm-text">
                                            <span class="perm-name" style="color: #ef4444;">Painel de Controle
                                                MASTER</span>
                                            <span class="perm-desc">Acesso total √†s configura√ß√µes, acessos, backups e
                                                auditoria avan√ßada.</span>
                                        </div>
                                    </div>
                                </label>
                            </div>

                        </div>
                    </div>
                </form>
            </div>
            <footer class="modal-footer"
                style="border-top: 1px solid rgba(255,255,255,0.05); padding-top: 1.5rem; margin-top: 1rem;">
                <div style="display: flex; gap: 0.8rem; margin-left: auto;">
                    <button type="button" class="btn btn-secondary" id="cargo-modal-cancel"
                        style="padding: 0.6rem 1.5rem;">Cancelar</button>
                    <button type="submit" form="admin-cargo-form" class="btn btn-primary"
                        style="padding: 0.6rem 1.5rem;"><i class="fa-solid fa-shield-check"
                            style="margin-right: 8px;"></i> Salvar Perfil</button>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modal: Alerta Sem Rotina Eventual -->
    <div id="modal-sem-rotina-eventual" class="modal-overlay">
        <div class="glass-card"
            style="width: 100%; max-width: 440px; padding: 2.5rem 2rem; border-radius: 16px; text-align: center; position: relative;">
            <div style="margin-bottom: 1.5rem;">
                <div
                    style="width: 70px; height: 70px; background: rgba(245, 158, 11, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.2rem; border: 1px solid rgba(245, 158, 11, 0.2);">
                    <i class="fa-solid fa-triangle-exclamation" style="color: var(--warning); font-size: 2.2rem;"></i>
                </div>
                <h2 style="font-size: 1.4rem; margin-bottom: 0.8rem; font-weight: 600;">Nenhuma Rotina Eventual</h2>
                <p style="color: var(--text-muted); font-size: 0.95rem; line-height: 1.6; margin-bottom: 0;">
                    Voc√™ ainda n√£o possui rotinas eventuais cadastradas. Por favor, acesse a <strong>Gest√£o de
                        Rotinas</strong> e crie uma rotina com a frequ√™ncia "Eventual" para poder atribu√≠-la a um
                    cliente.
                </p>
            </div>
            <button class="btn btn-primary" onclick="closeModalSemRotinaEventual()"
                style="width: 100%; padding: 0.9rem; font-size: 1rem; border-radius: 8px; justify-content: center;">Entendi</button>
        </div>
    </div>

    <!-- Modal: Nova Demanda Eventual -->
    <div id="modal-demanda-eventual" class="modal-overlay">
        <div class="glass-card"
            style="width: 100%; max-width: 480px; padding: 2rem; border-radius: 16px; position:relative;">
            <div style="display:flex; align-items:center; gap:0.75rem; margin-bottom:1.5rem;">
                <i class="fa-solid fa-bolt" style="color:var(--warning); font-size:1.3rem;"></i>
                <div>
                    <h2 style="font-size:1.1rem; margin:0;">Nova Rotina Eventual</h2>
                    <p style="font-size:0.8rem; color:var(--text-muted); margin:0;">Atribua uma rotina eventual a um
                        cliente agora</p>
                </div>
            </div>

            <div class="form-group" style="margin-bottom:1.2rem;">
                <label
                    style="font-size:0.8rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px;">Rotina
                    Eventual</label>
                <select id="evt-rotina-select" class="glass-select" style="width:100%; margin-top:0.5rem;"
                    onchange="onEventualRotinaChange()">
                    <option value="">‚Äî Selecione a Rotina ‚Äî</option>
                </select>
            </div>

            <div class="form-group" style="margin-bottom:1.2rem; position:relative;">
                <label
                    style="font-size:0.8rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px;">Cliente</label>
                <!-- Campo vis√≠vel (trigger) -->
                <div id="evt-cliente-trigger" onclick="toggleClienteDropdown()"
                    style="display:flex; align-items:center; justify-content:space-between; margin-top:0.5rem; padding:0.7rem 1rem; background:rgba(255,255,255,0.05); border:1px solid var(--border-glass); border-radius:var(--radius-sm); cursor:pointer; transition: border-color 0.2s;">
                    <span id="evt-cliente-label" style="color:var(--text-muted); font-size:0.9rem;">‚Äî Selecione o
                        Cliente ‚Äî</span>
                    <i class="fa-solid fa-chevron-down" id="evt-chevron"
                        style="color:var(--text-muted); font-size:0.75rem; transition:transform 0.2s;"></i>
                </div>
                <!-- Input hidden para guardar o id selecionado -->
                <input type="hidden" id="evt-cliente-select" value="">
                <!-- Painel do dropdown -->
                <div id="evt-cliente-dropdown"
                    style="display:none; position:absolute; top:100%; left:0; right:0; z-index:99999; background:var(--bg-card,#1e1e2e); border:1px solid var(--border-glass); border-radius:var(--radius-sm); box-shadow:0 8px 32px rgba(0,0,0,0.4); margin-top:4px; overflow:hidden;">
                    <!-- Busca interna -->
                    <div style="padding:0.6rem; border-bottom:1px solid var(--border-glass);">
                        <div class="search-wrapper" style="margin:0;">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            <input type="text" id="evt-cliente-busca" placeholder="Buscar cliente..."
                                oninput="filtrarClientesEventual(this.value)" autocomplete="off" style="width:100%;">
                        </div>
                    </div>
                    <!-- Lista de clientes -->
                    <ul id="evt-cliente-list"
                        style="list-style:none; margin:0; padding:0.3rem 0; max-height:200px; overflow-y:auto;">
                        <!-- Populado por JS -->
                    </ul>
                </div>
            </div>

            <div id="evt-prazo-preview"
                style="display:none; background:rgba(245,158,11,0.1); border:1px solid rgba(245,158,11,0.3); border-radius:10px; padding:0.75rem 1rem; margin-bottom:1.5rem; font-size:0.85rem;">
                <i class="fa-solid fa-calendar-clock" style="color:var(--warning);"></i>
                <span id="evt-prazo-text" style="margin-left:0.5rem; color:var(--text-main);"></span>
            </div>

            <div style="display:flex; gap:0.75rem; justify-content:flex-end;">
                <button class="btn btn-secondary" onclick="closeDemandaEventualModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="handleSaveDemandaEventual()" id="btn-confirmar-eventual">
                    <i class="fa-solid fa-check"></i> Confirmar Rotina
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Novo/Editar Post de Marketing -->
    <div id="modal-marketing-post" class="modal-overlay">
        <div class="glass-card modal-content" style="max-width: 600px;">
            <header class="modal-header">
                <h2><i class="fa-solid fa-file-pen"></i> Detalhes do Conte√∫do</h2>
                <button class="close-modal" onclick="Marketing.closePostModal()">&times;</button>
            </header>
            <div class="modal-body">
                <form id="form-marketing-post">
                    <input type="hidden" id="mk-post-id">
                    <div class="form-group">
                        <label>T√≠tulo do Post / Ideia</label>
                        <input type="text" id="mk-post-titulo" class="glass-select" style="width:100%;" required
                            placeholder="Ex: Dicas de Imposto de Renda">
                    </div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:1rem; margin-top:1rem;">
                        <div class="form-group">
                            <label>Plataforma</label>
                            <select id="mk-post-plataforma" class="glass-select" style="width:100%;">
                                <option value="Instagram">Instagram</option>
                                <option value="Facebook">Facebook</option>
                                <option value="WhatsApp">WhatsApp Business</option>
                                <option value="LinkedIn">LinkedIn</option>
                                <option value="YouTube">YouTube</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Formato</label>
                            <select id="mk-post-tipo" class="glass-select" style="width:100%;">
                                <option value="Post">Post Est√°tico</option>
                                <option value="Carrossel">Carrossel</option>
                                <option value="Reels">Reels / V√≠deo Curto</option>
                                <option value="Story">Story</option>
                                <option value="V√≠deo">V√≠deo Longo</option>
                            </select>
                        </div>
                    </div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:1rem; margin-top:1rem;">
                        <div class="form-group">
                            <label>Data de Publica√ß√£o</label>
                            <input type="date" id="mk-post-data" class="glass-select" style="width:100%;">
                        </div>
                        <div class="form-group">
                            <label>Respons√°vel</label>
                            <select id="mk-post-responsavel" class="glass-select" style="width:100%;">
                                <option value="">Selecione...</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-top:1rem;">
                        <label>Legenda / Copywriting</label>
                        <textarea id="mk-post-copy" class="glass-select"
                            style="width:100%; height:120px; font-family:inherit; padding:1rem;"
                            placeholder="Escreva aqui a legenda do post..."></textarea>
                    </div>
                    <div class="form-group" style="margin-top:1rem;">
                        <label>Prioridade</label>
                        <div style="display:flex; gap:1rem; margin-top:0.5rem;">
                            <label><input type="radio" name="mk-prioridade" value="Alta"> Alta</label>
                            <label><input type="radio" name="mk-prioridade" value="Normal" checked> Normal</label>
                            <label><input type="radio" name="mk-prioridade" value="Baixa"> Baixa</label>
                        </div>
                    </div>
                </form>
            </div>
            <footer class="modal-footer">
                <button class="btn btn-secondary" onclick="Marketing.closePostModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="Marketing.savePost()">Salvar Conte√∫do</button>
            </footer>
        </div>
    </div>

    <!-- Modal: Nova/Editar Campanha -->
    <div id="modal-marketing-campanha" class="modal-overlay">
        <div class="glass-card modal-content" style="max-width: 500px;">
            <header class="modal-header">
                <h2><i class="fa-solid fa-rocket"></i> Detalhes da Campanha</h2>
                <button class="close-modal" onclick="Marketing.closeCampanhaModal()">&times;</button>
            </header>
            <div class="modal-body">
                <form id="form-marketing-campanha">
                    <input type="hidden" id="mk-camp-id">
                    <div class="form-group">
                        <label>Nome da Campanha</label>
                        <input type="text" id="mk-camp-nome" class="glass-select" style="width:100%;" required>
                    </div>
                    <div class="form-group" style="margin-top:1rem;">
                        <label>Objetivo Estrat√©gico</label>
                        <input type="text" id="mk-camp-objetivo" class="glass-select" style="width:100%;"
                            placeholder="Ex: Capta√ß√£o de Clientes IRPF">
                    </div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:1rem; margin-top:1rem;">
                        <div class="form-group">
                            <label>In√≠cio</label>
                            <input type="date" id="mk-camp-inicio" class="glass-select" style="width:100%;">
                        </div>
                        <div class="form-group">
                            <label>Fim</label>
                            <input type="date" id="mk-camp-fim" class="glass-select" style="width:100%;">
                        </div>
                    </div>
                    <div class="form-group" style="margin-top:1rem;">
                        <label>Or√ßamento Previsto (R$)</label>
                        <input type="number" id="mk-camp-orcamento" class="glass-select" style="width:100%;"
                            step="0.01">
                    </div>
                </form>
            </div>
            <footer class="modal-footer">
                <button class="btn btn-secondary" onclick="Marketing.closeCampanhaModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="Marketing.saveCampanha()">Salvar Campanha</button>
            </footer>
        </div>
    </div>

    <!-- Modal: Adicionar Membro Equipe Marketing -->
    <div id="modal-marketing-equipe" class="modal-overlay">
        <div class="glass-card modal-content" style="max-width: 450px;">
            <header class="modal-header">
                <h2><i class="fa-solid fa-user-plus"></i> Adicionar √† Equipe</h2>
                <button class="close-modal" onclick="Marketing.closeEquipeModal()">&times;</button>
            </header>
            <div class="modal-body">
                <form id="form-marketing-equipe">
                    <div class="form-group">
                        <label>Funcion√°rio</label>
                        <select id="mk-equipe-funcionario" class="glass-select" style="width:100%;" required>
                            <option value="">Selecione um funcion√°rio...</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-top:1.5rem;">
                        <label>Fun√ß√£o no Marketing</label>
                        <select id="mk-equipe-funcao" class="glass-select" style="width:100%;" required>
                            <option value="Social Media">Social Media</option>
                            <option value="Designer">Designer</option>
                            <option value="Copywriter">Copywriter</option>
                            <option value="Gestor de Tr√°fego">Gestor de Tr√°fego</option>
                            <option value="Editor de V√≠deo">Editor de V√≠deo</option>
                        </select>
                    </div>
                </form>
            </div>
            <footer class="modal-footer">
                <button class="btn btn-secondary" onclick="Marketing.closeEquipeModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="Marketing.saveEquipeMember()">
                    <i class="fa-solid fa-save"></i> Adicionar Membro
                </button>
            </footer>
        </div>
    </div>

    <!-- Modal: For√ßar Nova Compet√™ncia -->
    <div id="modal-add-competencia" class="modal-overlay">
        <div class="glass-card modal-content" style="max-width: 450px;">
            <header class="modal-header">
                <h2><i class="fa-solid fa-calendar-plus highlight-text"></i> Nova Compet√™ncia</h2>
                <button class="close-btn" onclick="closeAddCompetenciaModal()"><i
                        class="fa-solid fa-xmark"></i></button>
            </header>
            <div class="modal-body" style="text-align: center;">
                <div
                    style="background: rgba(99, 102, 241, 0.1); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                    <i class="fa-solid fa-calendar-days" style="font-size: 2.5rem; color: var(--primary);"></i>
                </div>
                <p style="color: var(--text-muted); margin-bottom: 2rem; line-height: 1.5; font-size: 0.95rem;">
                    Preencha o c√≥digo da nova compet√™ncia. Ser√£o geradas automaticamente todas as rotinas atreladas
                    aos
                    clientes para este m√™s.
                </p>
                <div class="form-group" style="text-align: left;">
                    <label>C√≥digo da Compet√™ncia (YYYY-MM)</label>
                    <input type="text" id="add-comp-input" class="glass-input" placeholder="Ex: 2024-03" required
                        style="font-size: 1.25rem; text-align: center; letter-spacing: 2px;">
                </div>
            </div>
            <footer class="modal-footer" style="margin-top: 1rem;">
                <button class="btn btn-secondary" onclick="closeAddCompetenciaModal()">Cancelar</button>
                <button class="btn btn-primary" id="btn-confirm-add-comp"><i class="fa-solid fa-check"></i> Gerar
                    Compet√™ncia</button>
            </footer>
        </div>
    </div>

    <!-- Modal: Deletar Compet√™ncia -->
    <div id="modal-delete-competencia" class="modal-overlay">
        <div class="glass-card"
            style="width: 100%; max-width: 450px; padding: 2rem; border-radius: 16px; text-align: center;">
            <div
                style="background: rgba(239, 68, 68, 0.1); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                <i class="fa-solid fa-triangle-exclamation" style="font-size: 2.5rem; color: var(--danger);"></i>
            </div>
            <h2 style="margin-bottom: 1rem; color: var(--text-light);">Excluir Compet√™ncia</h2>
            <p style="color: var(--text-muted); margin-bottom: 2rem; line-height: 1.5;" id="delete-comp-msg">
                Voc√™ est√° prestes a apagar essa compet√™ncia inteira, junto com todas as tarefas vinculadas a ela.
                Esta √©
                uma a√ß√£o destrutiva irrevers√≠vel.
            </p>
            <input type="hidden" id="delete-comp-id">
            <div style="display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeDeleteCompetenciaModal()"
                    style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" id="btn-confirm-delete-comp"
                    style="flex: 1; background: var(--danger); border-color: var(--danger);"> <i
                        class="fa-solid fa-trash"></i> Excluir</button>
            </div>
        </div>
    </div>

    <!-- Modal: Desempenho Completo do Funcion√°rio -->
    <div id="modal-employee-performance" class="modal-overlay">
        <div class="glass-card"
            style="width: 95%; max-width: 1000px; max-height: 90vh; overflow-y: auto; padding: 2rem; display: flex; flex-direction: column; position: relative;">
            <header class="modal-header"
                style="margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: flex-start;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div
                        style="background: rgba(99, 102, 241, 0.1); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="fa-solid fa-user-tie" style="font-size: 2rem; color: var(--primary);"></i>
                    </div>
                    <div>
                        <h2 id="emp-perf-name" style="margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                            Nome
                            do Funcion√°rio</h2>
                        <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">Relat√≥rio Anal√≠tico de
                            Desempenho</p>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <select id="emp-perf-comp-filter" class="glass-select" style="min-width: 150px; margin: 0;"
                        onchange="updateEmployeePerformanceModal()">
                        <option value="Geral">Per√≠odo Geral</option>
                        <!-- Preenchido pelo JS -->
                    </select>
                    <button class="close-btn" onclick="closeEmployeePerformanceModal()"
                        style="position: absolute; top: 1.5rem; right: 1.5rem; background: transparent; z-index: 10;">
                        <i class="fa-solid fa-xmark"></i>
                    </button>
                </div>
            </header>

            <div class="modal-body">
                <!-- KPIs do Funcion√°rio -->
                <div class="kpi-dashboard-grid"
                    style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); margin-bottom: 2rem; gap: 1rem;">
                    <div class="glass-card kpi-chip" style="background: rgba(255,255,255,0.03); border: none;">
                        <div class="kpi-chip-icon"><i class="fa-solid fa-list-check"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Total Entregas</span>
                            <span class="kpi-chip-value" id="emp-kpi-total">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(16, 185, 129, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--success);"><i
                                class="fa-solid fa-check-double"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Conclu√≠das</span>
                            <span class="kpi-chip-value" id="emp-kpi-done">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(245, 158, 11, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--warning);"><i class="fa-solid fa-clock"></i>
                        </div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Pendentes/Prazo</span>
                            <span class="kpi-chip-value" id="emp-kpi-pend">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip" style="background: rgba(239, 68, 68, 0.05); border: none;">
                        <div class="kpi-chip-icon" style="color: var(--danger);"><i
                                class="fa-solid fa-triangle-exclamation"></i></div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Atrasadas</span>
                            <span class="kpi-chip-value" id="emp-kpi-late">0</span>
                        </div>
                    </div>
                    <div class="glass-card kpi-chip"
                        style="background: rgba(99, 102, 241, 0.08); border: 1px solid var(--primary-light);">
                        <div class="kpi-chip-icon" style="color: var(--primary-light);"><i class="fa-solid fa-bolt"></i>
                        </div>
                        <div class="kpi-chip-info">
                            <span class="kpi-chip-label">Efici√™ncia</span>
                            <span class="kpi-chip-value" id="emp-kpi-score">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficos do Funcion√°rio -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="glass-card"
                        style="padding: 1.5rem; display: flex; flex-direction: column; height: 320px;">
                        <h4
                            style="margin: 0 0 1rem 0; font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">
                            Status das Tarefas</h4>
                        <div style="flex: 1; position: relative;">
                            <canvas id="empStatusChart"></canvas>
                        </div>
                    </div>
                    <div class="glass-card"
                        style="padding: 1.5rem; display: flex; flex-direction: column; height: 320px;">
                        <h4
                            style="margin: 0 0 1rem 0; font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">
                            Produtividade por Compet√™ncia</h4>
                        <div style="flex: 1; position: relative;">
                            <canvas id="empProductionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Lista de Rotinas (Detalhado) -->
                <div class="glass-card full-table-container">
                    <div class="table-header-action"
                        style="padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-glass);">
                        <h3 style="margin: 0; font-size: 1.1rem;"><i class="fa-solid fa-list-ol"
                                style="color: var(--accent); margin-right: 8px;"></i> Detalhamento Operacional</h3>
                    </div>
                    <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                        <table class="data-table" id="emp-perf-detail-table">
                            <thead style="position: sticky; top: 0; z-index: 10;">
                                <tr>
                                    <th>Compet√™ncia</th>
                                    <th>Cliente</th>
                                    <th>Rotina</th>
                                    <th>Prazo/Feito Em</th>
                                    <th>Status</th>
                                    <th>Tempo Estim.</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Preenchido pelo JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Camada de Sucesso / Libera√ß√£o Antecipada -->
    <div id="success-overlay" class="shutdown-overlay"
        style="background: rgba(16, 185, 129, 0.95); opacity: 0; pointer-events: none; transition: opacity 0.5s ease; flex-direction: column; text-align: center; justify-content: center; align-items: center; z-index: 100000; display: flex; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;">
        <div
            style="background: rgba(255,255,255,0.1); border-radius: 50%; width: 120px; height: 120px; display: flex; align-items: center; justify-content: center; margin-bottom: 2rem; box-shadow: 0 0 50px rgba(255,255,255,0.2);">
            <i class="fa-solid fa-trophy" style="font-size: 4rem; color: #fff;"></i>
        </div>
        <h1 style="color: #fff; font-size: 3rem; margin-bottom: 1rem; text-shadow: 0 4px 20px rgba(0,0,0,0.3);">
            Parab√©ns!</h1>
        <h2 id="success-overlay-title"
            style="color: rgba(255,255,255,0.9); font-size: 1.5rem; font-weight: 500; margin-bottom: 1rem; text-shadow: 0 2px 10px rgba(0,0,0,0.2);">
            Voc√™ concluiu a compet√™ncia!</h2>
        <p id="success-overlay-message"
            style="color: rgba(255,255,255,0.8); font-size: 1.1rem; max-width: 500px; line-height: 1.6;">O pr√≥ximo
            m√™s
            foi liberado para voc√™ antecipadamente.</p>
    </div>

    <!-- Cont√™iner de Anima√ß√£o para Messenger -->
    <div id="paper-plane-container" class="paper-plane-animation"></div>

    <!-- Camada de Desligamento / Encerramento -->
    <div id="shutdown-overlay" class="shutdown-overlay"></div>

    <!-- Modal de Confirma√ß√£o Premium -->
    <div class="modal-overlay" id="modal-confirm-premium">
        <div class="glass-card modal-content" style="max-width: 400px; padding: 2.5rem; text-align: center;">
            <div id="confirm-icon" style="font-size: 3.5rem; color: var(--warning); margin-bottom: 1.5rem;">
                <i class="fa-solid fa-circle-exclamation"></i>
            </div>
            <h2 id="confirm-title" style="margin-bottom: 1rem; font-size: 1.5rem;">Confirma√ß√£o</h2>
            <p id="confirm-message" style="color: var(--text-muted); margin-bottom: 2rem; line-height: 1.6;">Deseja
                realizar esta a√ß√£o?</p>

            <div style="display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-secondary" id="confirm-cancel"
                    style="flex: 1; padding: 0.8rem; display: flex; justify-content: center; align-items: center; text-align: center;">Cancelar</button>
                <button class="btn btn-primary" id="confirm-ok"
                    style="flex: 1; padding: 0.8rem; background: var(--danger); border-color: var(--danger); display: flex; justify-content: center; align-items: center; text-align: center;">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Bibliotecas Externas -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="js/store.js?v=2.5"></script>
    <script src="js/marketing.js?v=2.5"></script>
    <script src="js/app.js?v=2.5"></script>
</body>

</html>